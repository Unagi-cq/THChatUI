(self["webpackChunkTHChatUI"]=self["webpackChunkTHChatUI"]||[]).push([[191],{32984:function(e,t,o){function s(e,t,o,s,l,i){let p={};switch(s){case"text_ali":p={model:e,input:{messages:n(t,o)},parameters:{result_format:"message",incremental_output:!0}},i&&(p.parameters.enable_search=!0);break;case"text_baidu":p={model:e,messages:n(t,o),stream:!0},i&&(p.web_search={enable:!0});break;case"text_xunfei":p={parameter:{chat:{domain:"general",temperature:.5,max_tokens:1024}},payload:{message:{text:n(t,o)}}};break;case"text_moonshot_zhipu":p={model:e,messages:n(t,o),stream:!0};break;case"local":p={input:{prompt:t,history:m(o),files:l}};break;case"img_ali":p={model:e,input:{messages:r(t,o,l)},parameters:{result_format:"message",incremental_output:!0}};break;case"img_zhipu":p={model:e,messages:a(t,o,l),stream:!0};break;case"igm_zhipu":p={model:e,prompt:t};break}return p}function n(e,t){function o(e){const t=[];for(let o=0;o<e.length-1;o++){const s=e[o];t.push({role:"user",content:s.query}),t.push({role:"assistant",content:s.answer})}return t}let s=o(t);return s.push({role:"user",content:e}),s}function a(e,t,o){function s(e){const t=[];for(let o=0;o<e.length-1;o++){const s=e[o];t.push({role:"user",content:[{type:"text",text:s.query}]}),t.push({role:"assistant",content:[{type:"text",text:s.answer}]})}return t}let n=s(t),a=[];return o&&o.length>0&&o[0].base64&&a.push({type:"image_url",image_url:{url:o[0].base64}}),a.push({type:"text",text:e}),n.push({role:"user",content:a}),n}function r(e,t,o){function s(e){const t=[];for(let o=0;o<e.length-1;o++){const s=e[o];t.push({role:"user",content:[{text:s.query}]}),t.push({role:"assistant",content:[{text:s.answer}]})}return t}let n=s(t),a=[];return o&&o.length>0&&o[0].base64&&a.push({image:o[0].base64}),a.push({text:e}),n.push({role:"user",content:a}),n}function m(e){const t=[];for(let o=0;o<e.length;o++){const s=e[o];t.push({user:s.query,assistant:s.answer})}return t}function l(e,t){switch(t){case"base":return{content:JSON.parse(e.data).output.choices[0].message.content};case"text":const o=JSON.parse(e.data).output.choices[0].message.content;return{content:o&&o.length>0?o[0].text:""};case"add":return{content:e};case"delta":return{content:JSON.parse(e.data).choices[0].delta.content};case"delta_reasoning":return JSON.parse(e.data).choices[0].delta.reasoning_content?{reasoning_content:JSON.parse(e.data).choices[0].delta.reasoning_content}:{content:JSON.parse(e.data).choices[0].delta.content};case"baidu":return{content:JSON.parse(e.data).result};case"llm_local":if("data"!==e.event)return"";const s=JSON.parse(e.data);try{return{content:s.data.content}}catch(e){console.error(e)}case"igm_zhipu":return{content:e.data[0].url};default:return console.warn(`未知的后处理方法: ${t}`),e}}o(44114),e.exports={model_list:{Ali_DashScope:{platform_name:"阿里云百炼",list:[{type:"llm",name:"qwen-turbo",series:"qwen",version:"qwen-turbo-latest",pre_method:"text_ali",post_method:"base",can_web_search:!0},{type:"llm",name:"qwen-plus",series:"qwen",version:"qwen-plus-latest",pre_method:"text_ali",post_method:"base",can_web_search:!0},{type:"llm",name:"qwen-max",series:"qwen",version:"qwen-max-latest",pre_method:"text_ali",post_method:"base",can_web_search:!0},{type:"llm",name:"qwen-math-turbo",series:"qwen",version:"qwen-math-turbo-latest",pre_method:"text_ali",post_method:"base"},{type:"llm",name:"qwen-coder-plus",series:"qwen",version:"qwen-coder-plus-latest",pre_method:"text_ali",post_method:"base"},{type:"vim",name:"qwen-vl-max",series:"qwen",version:"qwen-vl-max-latest",pre_method:"img_ali",post_method:"text"},{type:"vim",name:"qwen-vl-plus",series:"qwen",version:"qwen-vl-plus-latest",pre_method:"img_ali",post_method:"text"},{type:"vim",name:"qwen-vl-ocr",series:"qwen",version:"qwen-vl-ocr-latest",pre_method:"img_ali",post_method:"text"}]},Baidu_QianFan:{platform_name:"百度千帆",list:[{type:"llm",name:"ernie-4.0-8k",series:"wenxin",version:"ernie-4.0-8k-latest",pre_method:"text_baidu",post_method:"baidu",can_web_search:!0},{type:"llm",name:"ernie-speed-128k",series:"wenxin",version:"ernie-speed-128k",pre_method:"text_baidu",post_method:"baidu"},{type:"llm",name:"ernie-tiny-8k",series:"wenxin",version:"ernie-tiny-8k",pre_method:"text_baidu",post_method:"baidu"},{type:"llm",name:"ernie-lite-8k",series:"wenxin",version:"ernie-lite-8k",pre_method:"text_baidu",post_method:"baidu"},{type:"llm",name:"Yi-34B-Chat",series:"yi",version:"yi_34b_chat",pre_method:"text_baidu",post_method:"baidu"}]},Moonshot_AI:{platform_name:"月之暗面",list:[{type:"llm",name:"moonshot-v1-8k",series:"moonshot",version:"moonshot-v1-8k",pre_method:"text_moonshot_zhipu",post_method:"delta"},{type:"llm",name:"moonshot-v1-32k",series:"moonshot",version:"moonshot-v1-32k",pre_method:"text_moonshot_zhipu",post_method:"delta"},{type:"llm",name:"moonshot-v1-128k",series:"moonshot",version:"moonshot-v1-128k",pre_method:"text_moonshot_zhipu",post_method:"delta"}]},Xunfei_Spark:{platform_name:"讯飞星火",list:[{type:"llm",name:"Spark Lite 🆓",series:"xunfei",version:"spark lite",pre_method:"text_xunfei",post_method:"add"}]},Zhipu_BigModel:{platform_name:"智谱AI",list:[{type:"llm",name:"glm-4-flash 🆓",series:"zhipu",version:"glm-4-flash",pre_method:"text_moonshot_zhipu",post_method:"delta"},{type:"llm",name:"glm-4-0520",series:"zhipu",version:"glm-4-0520",pre_method:"text_moonshot_zhipu",post_method:"delta"},{type:"llm",name:"glm-4-air",series:"zhipu",version:"glm-4-air",pre_method:"text_moonshot_zhipu",post_method:"delta"},{type:"llm",name:"glm-4-plus",series:"zhipu",version:"glm-4-plus",pre_method:"text_moonshot_zhipu",post_method:"delta"},{type:"llm",name:"glm-4-long",series:"zhipu",version:"glm-4-long",pre_method:"text_moonshot_zhipu",post_method:"delta"},{type:"llm",name:"glm-4-flashx",series:"zhipu",version:"glm-4-flashx",pre_method:"text_moonshot_zhipu",post_method:"delta"},{type:"llm",name:"glm-4-airx",series:"zhipu",version:"glm-4-airx",pre_method:"text_moonshot_zhipu",post_method:"delta"},{type:"llm",name:"glm-4",series:"zhipu",version:"glm-4",pre_method:"text_moonshot_zhipu",post_method:"delta"},{type:"vim",name:"glm-4v",series:"zhipu",version:"glm-4v",pre_method:"img_zhipu",post_method:"delta"},{type:"igm",name:"cogview-3-flash 🆓",series:"zhipu",version:"cogview-3-flash",pre_method:"igm_zhipu",post_method:"igm_zhipu"},{type:"igm",name:"cogview-3",series:"zhipu",version:"cogview-3",pre_method:"igm_zhipu",post_method:"igm_zhipu"},{type:"igm",name:"cogview-3-plus",series:"zhipu",version:"cogview-3-plus",pre_method:"igm_zhipu",post_method:"igm_zhipu"}]},TT_Volcengine:{platform_name:"火山方舟",list:[{type:"llm",name:"deepseek-r1",series:"volcengine",version:"",pre_method:"text_moonshot_zhipu",post_method:"delta_reasoning"}]},Yidong_CMECloud:{platform_name:"移动云",list:[{type:"llm",name:"default",series:"default",version:"default",pre_method:"text_moonshot_zhipu",post_method:"delta"}]},OpenAI:{platform_name:"OpenAI",list:[{type:"llm",name:"llm",series:"default",version:"llm_default",pre_method:"text_moonshot_zhipu",post_method:"add"}]},Local:{platform_name:"本地调用",list:[{type:"llm",name:"对话模型",series:"local",version:"llm_local",pre_method:"local",post_method:"llm_local",can_web_search:!0},{type:"vim",name:"图片理解模型",series:"local",version:"vim_local",pre_method:"local",post_method:"llm_local"},{type:"igm",name:"图片生成模型",series:"local",version:"igm_local",pre_method:"local",post_method:"igm_zhipu"}]}},preProcess:s,postProcess:l}},67191:function(e,t,o){"use strict";o.r(t),o.d(t,{fetchAPI:function(){return r}});var s=o(32984),n=o(46387);const a=o(51701);async function r({prompt:e,history:t,files:o,controller:r,onopen:m,onmessage:l,onclose:i,onerror:p}){const{setting:h}=n.A.state,{model_config:_}=h,{pre_method:u}=_,{endpoint:d,api_key:c,model_name:g}=h.api_key_map["OpenAI"],v=new a({apiKey:c,baseURL:d,temperature:0,dangerouslyAllowBrowser:!0});try{const n=await v.chat.completions.create({...(0,s.preProcess)(g,e,t,u,o,!1),stream:!0});m?.();for await(const e of n){const t=e.choices[0]?.delta?.content||"";l?.(t)}i?.()}catch(x){throw p?.(x),x}}}}]);
//# sourceMappingURL=191.8047031d.js.map