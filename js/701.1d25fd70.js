(self["webpackChunkTHChatUI"]=self["webpackChunkTHChatUI"]||[]).push([[701],{530:function(e,t,n){"use strict";n(44114),n(18111),n(20116),n(61701),Object.defineProperty(t,"__esModule",{value:!0}),t.addOutputText=t.validateInputTools=t.shouldParseToolCall=t.isAutoParsableTool=t.makeParseableResponseTool=t.hasAutoParseableInput=t.parseResponse=t.maybeParseResponse=void 0;const r=n(18815),s=n(74178);function o(e,t){return t&&c(t)?i(e,t):{...e,output_parsed:null,output:e.output.map((e=>"function_call"===e.type?{...e,parsed_arguments:null}:"message"===e.type?{...e,content:e.content.map((e=>({...e,parsed:null})))}:e))}}function i(e,t){const n=e.output.map((e=>{if("function_call"===e.type)return{...e,parsed_arguments:f(t,e)};if("message"===e.type){const n=e.content.map((e=>"output_text"===e.type?{...e,parsed:a(t,e.text)}:e));return{...e,content:n}}return e})),r=Object.assign({},e,{output:n});return Object.getOwnPropertyDescriptor(e,"output_text")||m(r),Object.defineProperty(r,"output_parsed",{enumerable:!0,get(){for(const e of r.output)if("message"===e.type)for(const t of e.content)if("output_text"===t.type&&null!==t.parsed)return t.parsed;return null}}),r}function a(e,t){if("json_schema"!==e.text?.format?.type)return null;if("$parseRaw"in e.text?.format){const n=e.text?.format;return n.$parseRaw(t)}return JSON.parse(t)}function c(e){return!!(0,s.isAutoParsableResponseFormat)(e.text?.format)}function l(e,{parser:t,callback:n}){const r={...e};return Object.defineProperties(r,{$brand:{value:"auto-parseable-tool",enumerable:!1},$parseRaw:{value:t,enumerable:!1},$callback:{value:n,enumerable:!1}}),r}function u(e){return"auto-parseable-tool"===e?.["$brand"]}function d(e,t){return e.find((e=>"function"===e.type&&e.name===t))}function f(e,t){const n=d(e.tools??[],t.name);return{...t,...t,parsed_arguments:u(n)?n.$parseRaw(t.arguments):n?.strict?JSON.parse(t.arguments):null}}function h(e,t){if(!e)return!1;const n=d(e.tools??[],t.name);return u(n)||n?.strict||!1}function p(e){for(const t of e??[]){if("function"!==t.type)throw new r.OpenAIError(`Currently only \`function\` tool types support auto-parsing; Received \`${t.type}\``);if(!0!==t.function.strict)throw new r.OpenAIError(`The \`${t.function.name}\` tool is not marked with \`strict: true\`. Only strict function tools can be auto-parsed`)}}function m(e){const t=[];for(const n of e.output)if("message"===n.type)for(const e of n.content)"output_text"===e.type&&t.push(e.text);e.output_text=t.join("")}t.maybeParseResponse=o,t.parseResponse=i,t.hasAutoParseableInput=c,t.makeParseableResponseTool=l,t.isAutoParsableTool=u,t.shouldParseToolCall=h,t.validateInputTools=p,t.addOutputText=m},964:function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var s=Object.getOwnPropertyDescriptor(t,n);s&&!("get"in s?!t.__esModule:s.writable||s.configurable)||(s={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,s)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e["default"]=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return s(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.EvalListResponsesPage=t.Evals=void 0;const i=n(56497),a=n(25370),c=o(n(32266)),l=n(32266),u=n(84873);class d extends i.APIResource{constructor(){super(...arguments),this.runs=new c.Runs(this._client)}create(e,t){return this._client.post("/evals",{body:e,...t})}retrieve(e,t){return this._client.get(`/evals/${e}`,t)}update(e,t,n){return this._client.post(`/evals/${e}`,{body:t,...n})}list(e={},t){return(0,a.isRequestOptions)(e)?this.list({},e):this._client.getAPIList("/evals",f,{query:e,...t})}del(e,t){return this._client.delete(`/evals/${e}`,t)}}t.Evals=d;class f extends u.CursorPage{}t.EvalListResponsesPage=f,d.EvalListResponsesPage=f,d.Runs=l.Runs,d.RunListResponsesPage=l.RunListResponsesPage},1436:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.OutputItemListResponsesPage=t.OutputItems=void 0;const r=n(56497),s=n(25370),o=n(84873);class i extends r.APIResource{retrieve(e,t,n,r){return this._client.get(`/evals/${e}/runs/${t}/output_items/${n}`,r)}list(e,t,n={},r){return(0,s.isRequestOptions)(n)?this.list(e,t,{},n):this._client.getAPIList(`/evals/${e}/runs/${t}/output_items`,a,{query:n,...r})}}t.OutputItems=i;class a extends o.CursorPage{}t.OutputItemListResponsesPage=a,i.OutputItemListResponsesPage=a},3448:function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var s=Object.getOwnPropertyDescriptor(t,n);s&&!("get"in s?!t.__esModule:s.writable||s.configurable)||(s={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,s)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e["default"]=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return s(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.VectorStoreSearchResponsesPage=t.VectorStoresPage=t.VectorStores=void 0;const i=n(56497),a=n(25370),c=o(n(82757)),l=n(82757),u=o(n(38827)),d=n(38827),f=n(84873);class h extends i.APIResource{constructor(){super(...arguments),this.files=new u.Files(this._client),this.fileBatches=new c.FileBatches(this._client)}create(e,t){return this._client.post("/vector_stores",{body:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t?.headers}})}retrieve(e,t){return this._client.get(`/vector_stores/${e}`,{...t,headers:{"OpenAI-Beta":"assistants=v2",...t?.headers}})}update(e,t,n){return this._client.post(`/vector_stores/${e}`,{body:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}list(e={},t){return(0,a.isRequestOptions)(e)?this.list({},e):this._client.getAPIList("/vector_stores",p,{query:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t?.headers}})}del(e,t){return this._client.delete(`/vector_stores/${e}`,{...t,headers:{"OpenAI-Beta":"assistants=v2",...t?.headers}})}search(e,t,n){return this._client.getAPIList(`/vector_stores/${e}/search`,m,{body:t,method:"post",...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}}t.VectorStores=h;class p extends f.CursorPage{}t.VectorStoresPage=p;class m extends f.Page{}t.VectorStoreSearchResponsesPage=m,h.VectorStoresPage=p,h.VectorStoreSearchResponsesPage=m,h.Files=d.Files,h.VectorStoreFilesPage=d.VectorStoreFilesPage,h.FileContentResponsesPage=d.FileContentResponsesPage,h.FileBatches=l.FileBatches},8332:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FineTuningJobCheckpointsPage=t.Checkpoints=void 0;const r=n(56497),s=n(25370),o=n(84873);class i extends r.APIResource{list(e,t={},n){return(0,s.isRequestOptions)(t)?this.list(e,{},t):this._client.getAPIList(`/fine_tuning/jobs/${e}/checkpoints`,a,{query:t,...n})}}t.Checkpoints=i;class a extends o.CursorPage{}t.FineTuningJobCheckpointsPage=a,i.FineTuningJobCheckpointsPage=a},9347:function(e,t){"use strict";function n(e){if(e[Symbol.asyncIterator])return e;const t=e.getReader();return{async next(){try{const e=await t.read();return e?.done&&t.releaseLock(),e}catch(e){throw t.releaseLock(),e}},async return(){const e=t.cancel();return t.releaseLock(),await e,{done:!0,value:void 0}},[Symbol.asyncIterator](){return this}}}Object.defineProperty(t,"__esModule",{value:!0}),t.ReadableStreamToAsyncIterable=void 0,t.ReadableStreamToAsyncIterable=n},11413:function(e,t,n){"use strict";n(44114),n(18111),n(7588),n(18237),Object.defineProperty(t,"__esModule",{value:!0}),t.maybe_map=t.combine=t.is_buffer=t.is_regexp=t.compact=t.encode=t.decode=t.assign_single_source=t.merge=void 0;const r=n(55972),s=Object.prototype.hasOwnProperty,o=Array.isArray,i=(()=>{const e=[];for(let t=0;t<256;++t)e.push("%"+((t<16?"0":"")+t.toString(16)).toUpperCase());return e})();function a(e){while(e.length>1){const t=e.pop();if(!t)continue;const n=t.obj[t.prop];if(o(n)){const e=[];for(let t=0;t<n.length;++t)"undefined"!==typeof n[t]&&e.push(n[t]);t.obj[t.prop]=e}}}function c(e,t){const n=t&&t.plainObjects?Object.create(null):{};for(let r=0;r<e.length;++r)"undefined"!==typeof e[r]&&(n[r]=e[r]);return n}function l(e,t,n={}){if(!t)return e;if("object"!==typeof t){if(o(e))e.push(t);else{if(!e||"object"!==typeof e)return[e,t];(n&&(n.plainObjects||n.allowPrototypes)||!s.call(Object.prototype,t))&&(e[t]=!0)}return e}if(!e||"object"!==typeof e)return[e].concat(t);let r=e;return o(e)&&!o(t)&&(r=c(e,n)),o(e)&&o(t)?(t.forEach((function(t,r){if(s.call(e,r)){const s=e[r];s&&"object"===typeof s&&t&&"object"===typeof t?e[r]=l(s,t,n):e.push(t)}else e[r]=t})),e):Object.keys(t).reduce((function(e,r){const o=t[r];return s.call(e,r)?e[r]=l(e[r],o,n):e[r]=o,e}),r)}function u(e,t){return Object.keys(t).reduce((function(e,n){return e[n]=t[n],e}),e)}function d(e,t,n){const r=e.replace(/\+/g," ");if("iso-8859-1"===n)return r.replace(/%[0-9a-f]{2}/gi,unescape);try{return decodeURIComponent(r)}catch(s){return r}}t.merge=l,t.assign_single_source=u,t.decode=d;const f=1024,h=(e,t,n,s,o)=>{if(0===e.length)return e;let a=e;if("symbol"===typeof e?a=Symbol.prototype.toString.call(e):"string"!==typeof e&&(a=String(e)),"iso-8859-1"===n)return escape(a).replace(/%u[0-9a-f]{4}/gi,(function(e){return"%26%23"+parseInt(e.slice(2),16)+"%3B"}));let c="";for(let l=0;l<a.length;l+=f){const e=a.length>=f?a.slice(l,l+f):a,t=[];for(let n=0;n<e.length;++n){let s=e.charCodeAt(n);45===s||46===s||95===s||126===s||s>=48&&s<=57||s>=65&&s<=90||s>=97&&s<=122||o===r.RFC1738&&(40===s||41===s)?t[t.length]=e.charAt(n):s<128?t[t.length]=i[s]:s<2048?t[t.length]=i[192|s>>6]+i[128|63&s]:s<55296||s>=57344?t[t.length]=i[224|s>>12]+i[128|s>>6&63]+i[128|63&s]:(n+=1,s=65536+((1023&s)<<10|1023&e.charCodeAt(n)),t[t.length]=i[240|s>>18]+i[128|s>>12&63]+i[128|s>>6&63]+i[128|63&s])}c+=t.join("")}return c};function p(e){const t=[{obj:{o:e},prop:"o"}],n=[];for(let r=0;r<t.length;++r){const e=t[r],s=e.obj[e.prop],o=Object.keys(s);for(let r=0;r<o.length;++r){const e=o[r],i=s[e];"object"===typeof i&&null!==i&&-1===n.indexOf(i)&&(t.push({obj:s,prop:e}),n.push(i))}}return a(t),e}function m(e){return"[object RegExp]"===Object.prototype.toString.call(e)}function g(e){return!(!e||"object"!==typeof e)&&!!(e.constructor&&e.constructor.isBuffer&&e.constructor.isBuffer(e))}function b(e,t){return[].concat(e,t)}function y(e,t){if(o(e)){const n=[];for(let r=0;r<e.length;r+=1)n.push(t(e[r]));return n}return t(e)}t.encode=h,t.compact=p,t.is_regexp=m,t.is_buffer=g,t.combine=b,t.maybe_map=y},15364:function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var s=Object.getOwnPropertyDescriptor(t,n);s&&!("get"in s?!t.__esModule:s.writable||s.configurable)||(s={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,s)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e["default"]=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return s(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.Translations=void 0;const i=n(56497),a=o(n(25370));class c extends i.APIResource{create(e,t){return this._client.post("/audio/translations",a.multipartFormRequestOptions({body:e,...t,__metadata:{model:e.model}}))}}t.Translations=c},18815:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ContentFilterFinishReasonError=t.LengthFinishReasonError=t.InternalServerError=t.RateLimitError=t.UnprocessableEntityError=t.ConflictError=t.NotFoundError=t.PermissionDeniedError=t.AuthenticationError=t.BadRequestError=t.APIConnectionTimeoutError=t.APIConnectionError=t.APIUserAbortError=t.APIError=t.OpenAIError=void 0;const r=n(25370);class s extends Error{}t.OpenAIError=s;class o extends s{constructor(e,t,n,r){super(`${o.makeMessage(e,t,n)}`),this.status=e,this.headers=r,this.request_id=r?.["x-request-id"],this.error=t;const s=t;this.code=s?.["code"],this.param=s?.["param"],this.type=s?.["type"]}static makeMessage(e,t,n){const r=t?.message?"string"===typeof t.message?t.message:JSON.stringify(t.message):t?JSON.stringify(t):n;return e&&r?`${e} ${r}`:e?`${e} status code (no body)`:r||"(no status code or body)"}static generate(e,t,n,s){if(!e||!s)return new a({message:n,cause:(0,r.castToError)(t)});const i=t?.["error"];return 400===e?new l(e,i,n,s):401===e?new u(e,i,n,s):403===e?new d(e,i,n,s):404===e?new f(e,i,n,s):409===e?new h(e,i,n,s):422===e?new p(e,i,n,s):429===e?new m(e,i,n,s):e>=500?new g(e,i,n,s):new o(e,i,n,s)}}t.APIError=o;class i extends o{constructor({message:e}={}){super(void 0,void 0,e||"Request was aborted.",void 0)}}t.APIUserAbortError=i;class a extends o{constructor({message:e,cause:t}){super(void 0,void 0,e||"Connection error.",void 0),t&&(this.cause=t)}}t.APIConnectionError=a;class c extends a{constructor({message:e}={}){super({message:e??"Request timed out."})}}t.APIConnectionTimeoutError=c;class l extends o{}t.BadRequestError=l;class u extends o{}t.AuthenticationError=u;class d extends o{}t.PermissionDeniedError=d;class f extends o{}t.NotFoundError=f;class h extends o{}t.ConflictError=h;class p extends o{}t.UnprocessableEntityError=p;class m extends o{}t.RateLimitError=m;class g extends o{}t.InternalServerError=g;class b extends s{constructor(){super("Could not parse response content as the length limit was reached")}}t.LengthFinishReasonError=b;class y extends s{constructor(){super("Could not parse response content as the request was rejected by the content filter")}}t.ContentFilterFinishReasonError=y},19700:function(e,t){"use strict";function n(e){return"function"===typeof e.parse}Object.defineProperty(t,"__esModule",{value:!0}),t.ParsingToolFunction=t.ParsingFunction=t.isRunnableFunctionWithParse=void 0,t.isRunnableFunctionWithParse=n;class r{constructor(e){this.function=e.function,this.parse=e.parse,this.parameters=e.parameters,this.description=e.description,this.name=e.name}}t.ParsingFunction=r;class s{constructor(e){this.type="function",this.function=e}}t.ParsingToolFunction=s},20045:function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var s=Object.getOwnPropertyDescriptor(t,n);s&&!("get"in s?!t.__esModule:s.writable||s.configurable)||(s={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,s)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e["default"]=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return s(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.RunsPage=t.Runs=void 0;const i=n(56497),a=n(25370),c=n(90197),l=n(25370),u=o(n(83752)),d=n(83752),f=n(84873);class h extends i.APIResource{constructor(){super(...arguments),this.steps=new u.Steps(this._client)}create(e,t,n){const{include:r,...s}=t;return this._client.post(`/threads/${e}/runs`,{query:{include:r},body:s,...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers},stream:t.stream??!1})}retrieve(e,t,n){return this._client.get(`/threads/${e}/runs/${t}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}update(e,t,n,r){return this._client.post(`/threads/${e}/runs/${t}`,{body:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r?.headers}})}list(e,t={},n){return(0,a.isRequestOptions)(t)?this.list(e,{},t):this._client.getAPIList(`/threads/${e}/runs`,p,{query:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}cancel(e,t,n){return this._client.post(`/threads/${e}/runs/${t}/cancel`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}async createAndPoll(e,t,n){const r=await this.create(e,t,n);return await this.poll(e,r.id,n)}createAndStream(e,t,n){return c.AssistantStream.createAssistantStream(e,this._client.beta.threads.runs,t,n)}async poll(e,t,n){const r={...n?.headers,"X-Stainless-Poll-Helper":"true"};n?.pollIntervalMs&&(r["X-Stainless-Custom-Poll-Interval"]=n.pollIntervalMs.toString());while(1){const{data:s,response:o}=await this.retrieve(e,t,{...n,headers:{...n?.headers,...r}}).withResponse();switch(s.status){case"queued":case"in_progress":case"cancelling":let e=5e3;if(n?.pollIntervalMs)e=n.pollIntervalMs;else{const t=o.headers.get("openai-poll-after-ms");if(t){const n=parseInt(t);isNaN(n)||(e=n)}}await(0,l.sleep)(e);break;case"requires_action":case"incomplete":case"cancelled":case"completed":case"failed":case"expired":return s}}}stream(e,t,n){return c.AssistantStream.createAssistantStream(e,this._client.beta.threads.runs,t,n)}submitToolOutputs(e,t,n,r){return this._client.post(`/threads/${e}/runs/${t}/submit_tool_outputs`,{body:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r?.headers},stream:n.stream??!1})}async submitToolOutputsAndPoll(e,t,n,r){const s=await this.submitToolOutputs(e,t,n,r);return await this.poll(e,s.id,r)}submitToolOutputsStream(e,t,n,r){return c.AssistantStream.createToolAssistantStream(e,t,this._client.beta.threads.runs,n,r)}}t.Runs=h;class p extends f.CursorPage{}t.RunsPage=p,h.RunsPage=p,h.Steps=d.Steps,h.RunStepsPage=d.RunStepsPage},20690:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Moderations=void 0;const r=n(56497);class s extends r.APIResource{create(e,t){return this._client.post("/moderations",{body:e,...t})}}t.Moderations=s},20757:function(e,t,n){"use strict";n(44114),n(18111),n(22489),n(7588);var r,s,o,i,a,c,l,u,d,f,h,p,m,g=this&&this.__classPrivateFieldSet||function(e,t,n,r,s){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!s)throw new TypeError("Private accessor was defined without a setter");if("function"===typeof t?e!==t||!s:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?s.call(e,n):s?s.value=n:t.set(e,n),n},b=this&&this.__classPrivateFieldGet||function(e,t,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"===typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(e):r?r.value:t.get(e)};Object.defineProperty(t,"__esModule",{value:!0}),t.EventStream=void 0;const y=n(18815);class _{constructor(){r.add(this),this.controller=new AbortController,s.set(this,void 0),o.set(this,(()=>{})),i.set(this,(()=>{})),a.set(this,void 0),c.set(this,(()=>{})),l.set(this,(()=>{})),u.set(this,{}),d.set(this,!1),f.set(this,!1),h.set(this,!1),p.set(this,!1),g(this,s,new Promise(((e,t)=>{g(this,o,e,"f"),g(this,i,t,"f")})),"f"),g(this,a,new Promise(((e,t)=>{g(this,c,e,"f"),g(this,l,t,"f")})),"f"),b(this,s,"f").catch((()=>{})),b(this,a,"f").catch((()=>{}))}_run(e){setTimeout((()=>{e().then((()=>{this._emitFinal(),this._emit("end")}),b(this,r,"m",m).bind(this))}),0)}_connected(){this.ended||(b(this,o,"f").call(this),this._emit("connect"))}get ended(){return b(this,d,"f")}get errored(){return b(this,f,"f")}get aborted(){return b(this,h,"f")}abort(){this.controller.abort()}on(e,t){const n=b(this,u,"f")[e]||(b(this,u,"f")[e]=[]);return n.push({listener:t}),this}off(e,t){const n=b(this,u,"f")[e];if(!n)return this;const r=n.findIndex((e=>e.listener===t));return r>=0&&n.splice(r,1),this}once(e,t){const n=b(this,u,"f")[e]||(b(this,u,"f")[e]=[]);return n.push({listener:t,once:!0}),this}emitted(e){return new Promise(((t,n)=>{g(this,p,!0,"f"),"error"!==e&&this.once("error",n),this.once(e,t)}))}async done(){g(this,p,!0,"f"),await b(this,a,"f")}_emit(e,...t){if(b(this,d,"f"))return;"end"===e&&(g(this,d,!0,"f"),b(this,c,"f").call(this));const n=b(this,u,"f")[e];if(n&&(b(this,u,"f")[e]=n.filter((e=>!e.once)),n.forEach((({listener:e})=>e(...t)))),"abort"===e){const e=t[0];return b(this,p,"f")||n?.length||Promise.reject(e),b(this,i,"f").call(this,e),b(this,l,"f").call(this,e),void this._emit("end")}if("error"===e){const e=t[0];b(this,p,"f")||n?.length||Promise.reject(e),b(this,i,"f").call(this,e),b(this,l,"f").call(this,e),this._emit("end")}}_emitFinal(){}}t.EventStream=_,s=new WeakMap,o=new WeakMap,i=new WeakMap,a=new WeakMap,c=new WeakMap,l=new WeakMap,u=new WeakMap,d=new WeakMap,f=new WeakMap,h=new WeakMap,p=new WeakMap,r=new WeakSet,m=function(e){if(g(this,f,!0,"f"),e instanceof Error&&"AbortError"===e.name&&(e=new y.APIUserAbortError),e instanceof y.APIUserAbortError)return g(this,h,!0,"f"),this._emit("abort",e);if(e instanceof y.OpenAIError)return this._emit("error",e);if(e instanceof Error){const t=new y.OpenAIError(e.message);return t.cause=e,this._emit("error",t)}return this._emit("error",new y.OpenAIError(String(e)))}},21821:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ResponseItemsPage=t.InputItems=void 0;const r=n(56497),s=n(25370),o=n(76632);Object.defineProperty(t,"ResponseItemsPage",{enumerable:!0,get:function(){return o.ResponseItemsPage}});class i extends r.APIResource{list(e,t={},n){return(0,s.isRequestOptions)(t)?this.list(e,{},t):this._client.getAPIList(`/responses/${e}/input_items`,o.ResponseItemsPage,{query:t,...n})}}t.InputItems=i},22836:function(e,t,n){"use strict";n(17642),n(58004),n(33853),n(45876),n(32475),n(15024),n(31698);var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var s=Object.getOwnPropertyDescriptor(t,n);s&&!("get"in s?!t.__esModule:s.writable||s.configurable)||(s={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,s)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e["default"]=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return s(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.FileObjectsPage=t.Files=void 0;const i=n(56497),a=n(25370),c=n(25370),l=n(18815),u=o(n(25370)),d=n(84873);class f extends i.APIResource{create(e,t){return this._client.post("/files",u.multipartFormRequestOptions({body:e,...t}))}retrieve(e,t){return this._client.get(`/files/${e}`,t)}list(e={},t){return(0,a.isRequestOptions)(e)?this.list({},e):this._client.getAPIList("/files",h,{query:e,...t})}del(e,t){return this._client.delete(`/files/${e}`,t)}content(e,t){return this._client.get(`/files/${e}/content`,{...t,headers:{Accept:"application/binary",...t?.headers},__binaryResponse:!0})}retrieveContent(e,t){return this._client.get(`/files/${e}/content`,t)}async waitForProcessing(e,{pollInterval:t=5e3,maxWait:n=18e5}={}){const r=new Set(["processed","error","deleted"]),s=Date.now();let o=await this.retrieve(e);while(!o.status||!r.has(o.status))if(await(0,c.sleep)(t),o=await this.retrieve(e),Date.now()-s>n)throw new l.APIConnectionTimeoutError({message:`Giving up on waiting for file ${e} to finish processing after ${n} milliseconds.`});return o}}t.Files=f;class h extends d.CursorPage{}t.FileObjectsPage=h,f.FileObjectsPage=h},23406:function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var s=Object.getOwnPropertyDescriptor(t,n);s&&!("get"in s?!t.__esModule:s.writable||s.configurable)||(s={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,s)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e["default"]=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return s(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.Chat=void 0;const i=n(56497),a=o(n(63625)),c=n(63625);class l extends i.APIResource{constructor(){super(...arguments),this.completions=new a.Completions(this._client)}}t.Chat=l,l.Completions=c.Completions,l.ChatCompletionsPage=c.ChatCompletionsPage},23874:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TranscriptionSessions=void 0;const r=n(56497);class s extends r.APIResource{create(e,t){return this._client.post("/realtime/transcription_sessions",{body:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t?.headers}})}}t.TranscriptionSessions=s},25148:function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var s=Object.getOwnPropertyDescriptor(t,n);s&&!("get"in s?!t.__esModule:s.writable||s.configurable)||(s={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,s)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e["default"]=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return s(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.Parts=void 0;const i=n(56497),a=o(n(25370));class c extends i.APIResource{create(e,t,n){return this._client.post(`/uploads/${e}/parts`,a.multipartFormRequestOptions({body:t,...n}))}}t.Parts=c},25370:function(e,t,n){"use strict";n(18111),n(81148),n(22489),n(61701),n(17642),n(58004),n(33853),n(45876),n(32475),n(15024),n(31698),n(64979);var r,s=this&&this.__classPrivateFieldSet||function(e,t,n,r,s){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!s)throw new TypeError("Private accessor was defined without a setter");if("function"===typeof t?e!==t||!s:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?s.call(e,n):s?s.value=n:t.set(e,n),n},o=this&&this.__classPrivateFieldGet||function(e,t,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"===typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(e):r?r.value:t.get(e)};Object.defineProperty(t,"__esModule",{value:!0}),t.isObj=t.toFloat32Array=t.toBase64=t.getHeader=t.getRequiredHeader=t.isHeadersProtocol=t.isRunningInBrowser=t.debug=t.hasOwn=t.isEmptyObj=t.maybeCoerceBoolean=t.maybeCoerceFloat=t.maybeCoerceInteger=t.coerceBoolean=t.coerceFloat=t.coerceInteger=t.readEnv=t.ensurePresent=t.castToError=t.sleep=t.safeJSON=t.isRequestOptions=t.createResponseHeaders=t.PagePromise=t.AbstractPage=t.APIClient=t.APIPromise=t.createForm=t.multipartFormRequestOptions=t.maybeMultipartFormRequestOptions=void 0;const i=n(91533),a=n(25701),c=n(18815),l=n(86551);(0,l.init)();const u=n(78999);var d=n(78999);async function f(e){const{response:t}=e;if(e.options.stream)return J("response",t.status,t.url,t.headers,t.body),e.options.__streamClass?e.options.__streamClass.fromSSEResponse(t,e.controller):a.Stream.fromSSEResponse(t,e.controller);if(204===t.status)return null;if(e.options.__binaryResponse)return t;const n=t.headers.get("content-type"),r=n?.split(";")[0]?.trim(),s=r?.includes("application/json")||r?.endsWith("+json");if(s){const e=await t.json();return J("response",t.status,t.url,t.headers,e),h(e,t)}const o=await t.text();return J("response",t.status,t.url,t.headers,o),o}function h(e,t){return!e||"object"!==typeof e||Array.isArray(e)?e:Object.defineProperty(e,"_request_id",{value:t.headers.get("x-request-id"),enumerable:!1})}Object.defineProperty(t,"maybeMultipartFormRequestOptions",{enumerable:!0,get:function(){return d.maybeMultipartFormRequestOptions}}),Object.defineProperty(t,"multipartFormRequestOptions",{enumerable:!0,get:function(){return d.multipartFormRequestOptions}}),Object.defineProperty(t,"createForm",{enumerable:!0,get:function(){return d.createForm}});class p extends Promise{constructor(e,t=f){super((e=>{e(null)})),this.responsePromise=e,this.parseResponse=t}_thenUnwrap(e){return new p(this.responsePromise,(async t=>h(e(await this.parseResponse(t),t),t.response)))}asResponse(){return this.responsePromise.then((e=>e.response))}async withResponse(){const[e,t]=await Promise.all([this.parse(),this.asResponse()]);return{data:e,response:t,request_id:t.headers.get("x-request-id")}}parse(){return this.parsedPromise||(this.parsedPromise=this.responsePromise.then(this.parseResponse)),this.parsedPromise}then(e,t){return this.parse().then(e,t)}catch(e){return this.parse().catch(e)}finally(e){return this.parse().finally(e)}}t.APIPromise=p;class m{constructor({baseURL:e,maxRetries:t=2,timeout:n=6e5,httpAgent:r,fetch:s}){this.baseURL=e,this.maxRetries=x("maxRetries",t),this.timeout=x("timeout",n),this.httpAgent=r,this.fetch=s??l.fetch}authHeaders(e){return{}}defaultHeaders(e){return{Accept:"application/json","Content-Type":"application/json","User-Agent":this.getUserAgent(),...I(),...this.authHeaders(e)}}validateHeaders(e,t){}defaultIdempotencyKey(){return`stainless-node-retry-${H()}`}get(e,t){return this.methodRequest("get",e,t)}post(e,t){return this.methodRequest("post",e,t)}patch(e,t){return this.methodRequest("patch",e,t)}put(e,t){return this.methodRequest("put",e,t)}delete(e,t){return this.methodRequest("delete",e,t)}methodRequest(e,t,n){return this.request(Promise.resolve(n).then((async n=>{const r=n&&(0,u.isBlobLike)(n?.body)?new DataView(await n.body.arrayBuffer()):n?.body instanceof DataView?n.body:n?.body instanceof ArrayBuffer?new DataView(n.body):n&&ArrayBuffer.isView(n?.body)?new DataView(n.body.buffer):n?.body;return{method:e,path:t,...n,body:r}})))}getAPIList(e,t,n){return this.requestAPIList(t,{method:"get",path:e,...n})}calculateContentLength(e){if("string"===typeof e){if("undefined"!==typeof Buffer)return Buffer.byteLength(e,"utf8").toString();if("undefined"!==typeof TextEncoder){const t=new TextEncoder,n=t.encode(e);return n.length.toString()}}else if(ArrayBuffer.isView(e))return e.byteLength.toString();return null}buildRequest(e,{retryCount:t=0}={}){const n={...e},{method:r,path:s,query:o,headers:i={}}=n,a=ArrayBuffer.isView(n.body)||n.__binaryRequest&&"string"===typeof n.body?n.body:(0,u.isMultipartBody)(n.body)?n.body.body:n.body?JSON.stringify(n.body,null,2):null,c=this.calculateContentLength(a),d=this.buildURL(s,o);"timeout"in n&&x("timeout",n.timeout),n.timeout=n.timeout??this.timeout;const f=n.httpAgent??this.httpAgent??(0,l.getDefaultAgent)(d),h=n.timeout+1e3;"number"===typeof f?.options?.timeout&&h>(f.options.timeout??0)&&(f.options.timeout=h),this.idempotencyHeader&&"get"!==r&&(e.idempotencyKey||(e.idempotencyKey=this.defaultIdempotencyKey()),i[this.idempotencyHeader]=e.idempotencyKey);const p=this.buildHeaders({options:n,headers:i,contentLength:c,retryCount:t}),m={method:r,...a&&{body:a},headers:p,...f&&{agent:f},signal:n.signal??null};return{req:m,url:d,timeout:n.timeout}}buildHeaders({options:e,headers:n,contentLength:r,retryCount:s}){const o={};r&&(o["content-length"]=r);const i=this.defaultHeaders(e);return V(o,i),V(o,n),(0,u.isMultipartBody)(e.body)&&"node"!==l.kind&&delete o["content-type"],void 0===(0,t.getHeader)(i,"x-stainless-retry-count")&&void 0===(0,t.getHeader)(n,"x-stainless-retry-count")&&(o["x-stainless-retry-count"]=String(s)),void 0===(0,t.getHeader)(i,"x-stainless-timeout")&&void 0===(0,t.getHeader)(n,"x-stainless-timeout")&&e.timeout&&(o["x-stainless-timeout"]=String(Math.trunc(e.timeout/1e3))),this.validateHeaders(o,n),o}async prepareOptions(e){}async prepareRequest(e,{url:t,options:n}){}parseHeaders(e){return e?Symbol.iterator in e?Object.fromEntries(Array.from(e).map((e=>[...e]))):{...e}:{}}makeStatusError(e,t,n,r){return c.APIError.generate(e,t,n,r)}request(e,t=null){return new p(this.makeRequest(e,t))}async makeRequest(e,n){const r=await e,s=r.maxRetries??this.maxRetries;null==n&&(n=s),await this.prepareOptions(r);const{req:o,url:i,timeout:a}=this.buildRequest(r,{retryCount:s-n});if(await this.prepareRequest(o,{url:i,options:r}),J("request",i,r,o.headers),r.signal?.aborted)throw new c.APIUserAbortError;const l=new AbortController,u=await this.fetchWithTimeout(i,o,a,l).catch(t.castToError);if(u instanceof Error){if(r.signal?.aborted)throw new c.APIUserAbortError;if(n)return this.retryRequest(r,n);if("AbortError"===u.name)throw new c.APIConnectionTimeoutError;throw new c.APIConnectionError({cause:u})}const d=(0,t.createResponseHeaders)(u.headers);if(!u.ok){if(n&&this.shouldRetry(u)){const e=`retrying, ${n} attempts remaining`;return J(`response (error; ${e})`,u.status,i,d),this.retryRequest(r,n,d)}const e=await u.text().catch((e=>(0,t.castToError)(e).message)),s=(0,t.safeJSON)(e),o=s?void 0:e,a=n?"(error; no more retries left)":"(error; not retryable)";J(`response (error; ${a})`,u.status,i,d,o);const c=this.makeStatusError(u.status,s,o,d);throw c}return{response:u,options:r,controller:l}}requestAPIList(e,t){const n=this.makeRequest(t,null);return new b(this,n,e)}buildURL(e,t){const n=S(e)?new URL(e):new URL(this.baseURL+(this.baseURL.endsWith("/")&&e.startsWith("/")?e.slice(1):e)),r=this.defaultQuery();return q(r)||(t={...r,...t}),"object"===typeof t&&t&&!Array.isArray(t)&&(n.search=this.stringifyQuery(t)),n.toString()}stringifyQuery(e){return Object.entries(e).filter((([e,t])=>"undefined"!==typeof t)).map((([e,t])=>{if("string"===typeof t||"number"===typeof t||"boolean"===typeof t)return`${encodeURIComponent(e)}=${encodeURIComponent(t)}`;if(null===t)return`${encodeURIComponent(e)}=`;throw new c.OpenAIError(`Cannot stringify type ${typeof t}; Expected string, number, boolean, or null. If you need to pass nested query parameters, you can manually encode them, e.g. { query: { 'foo[key1]': value1, 'foo[key2]': value2 } }, and please open a GitHub issue requesting better support for your use case.`)})).join("&")}async fetchWithTimeout(e,t,n,r){const{signal:s,...o}=t||{};s&&s.addEventListener("abort",(()=>r.abort()));const i=setTimeout((()=>r.abort()),n),a={signal:r.signal,...o};return a.method&&(a.method=a.method.toUpperCase()),this.fetch.call(void 0,e,a).finally((()=>{clearTimeout(i)}))}shouldRetry(e){const t=e.headers.get("x-should-retry");return"true"===t||"false"!==t&&(408===e.status||(409===e.status||(429===e.status||e.status>=500)))}async retryRequest(e,n,r){let s;const o=r?.["retry-after-ms"];if(o){const e=parseFloat(o);Number.isNaN(e)||(s=e)}const i=r?.["retry-after"];if(i&&!s){const e=parseFloat(i);s=Number.isNaN(e)?Date.parse(i)-Date.now():1e3*e}if(!(s&&0<=s&&s<6e4)){const t=e.maxRetries??this.maxRetries;s=this.calculateDefaultRetryTimeoutMillis(n,t)}return await(0,t.sleep)(s),this.makeRequest(e,n-1)}calculateDefaultRetryTimeoutMillis(e,t){const n=.5,r=8,s=t-e,o=Math.min(n*Math.pow(2,s),r),i=1-.25*Math.random();return o*i*1e3}getUserAgent(){return`${this.constructor.name}/JS ${i.VERSION}`}}t.APIClient=m;class g{constructor(e,t,n,o){r.set(this,void 0),s(this,r,e,"f"),this.options=o,this.response=t,this.body=n}hasNextPage(){const e=this.getPaginatedItems();return!!e.length&&null!=this.nextPageInfo()}async getNextPage(){const e=this.nextPageInfo();if(!e)throw new c.OpenAIError("No next page expected; please check `.hasNextPage()` before calling `.getNextPage()`.");const t={...this.options};if("params"in e&&"object"===typeof t.query)t.query={...t.query,...e.params};else if("url"in e){const n=[...Object.entries(t.query||{}),...e.url.searchParams.entries()];for(const[t,r]of n)e.url.searchParams.set(t,r);t.query=void 0,t.path=e.url.toString()}return await o(this,r,"f").requestAPIList(this.constructor,t)}async*iterPages(){let e=this;yield e;while(e.hasNextPage())e=await e.getNextPage(),yield e}async*[(r=new WeakMap,Symbol.asyncIterator)](){for await(const e of this.iterPages())for(const t of e.getPaginatedItems())yield t}}t.AbstractPage=g;class b extends p{constructor(e,t,n){super(t,(async t=>new n(e,t.response,await f(t),t.options)))}async*[Symbol.asyncIterator](){const e=await(this);for await(const t of e)yield t}}t.PagePromise=b;const y=e=>new Proxy(Object.fromEntries(e.entries()),{get(e,t){const n=t.toString();return e[n.toLowerCase()]||e[n]}});t.createResponseHeaders=y;const _={method:!0,path:!0,query:!0,body:!0,headers:!0,maxRetries:!0,stream:!0,timeout:!0,httpAgent:!0,signal:!0,idempotencyKey:!0,__metadata:!0,__binaryRequest:!0,__binaryResponse:!0,__streamClass:!0},w=e=>"object"===typeof e&&null!==e&&!q(e)&&Object.keys(e).every((e=>U(_,e)));t.isRequestOptions=w;const v=()=>{if("undefined"!==typeof Deno&&null!=Deno.build)return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":i.VERSION,"X-Stainless-OS":A(Deno.build.os),"X-Stainless-Arch":O(Deno.build.arch),"X-Stainless-Runtime":"deno","X-Stainless-Runtime-Version":"string"===typeof Deno.version?Deno.version:Deno.version?.deno??"unknown"};if("undefined"!==typeof EdgeRuntime)return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":i.VERSION,"X-Stainless-OS":"Unknown","X-Stainless-Arch":`other:${EdgeRuntime}`,"X-Stainless-Runtime":"edge","X-Stainless-Runtime-Version":process.version};if("[object process]"===Object.prototype.toString.call("undefined"!==typeof process?process:0))return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":i.VERSION,"X-Stainless-OS":A(process.platform),"X-Stainless-Arch":O(process.arch),"X-Stainless-Runtime":"node","X-Stainless-Runtime-Version":process.version};const e=P();return e?{"X-Stainless-Lang":"js","X-Stainless-Package-Version":i.VERSION,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":`browser:${e.browser}`,"X-Stainless-Runtime-Version":e.version}:{"X-Stainless-Lang":"js","X-Stainless-Package-Version":i.VERSION,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"unknown","X-Stainless-Runtime-Version":"unknown"}};function P(){if("undefined"===typeof navigator||!navigator)return null;const e=[{key:"edge",pattern:/Edge(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/MSIE(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/Trident(?:.*rv\:(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"chrome",pattern:/Chrome(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"firefox",pattern:/Firefox(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"safari",pattern:/(?:Version\W+(\d+)\.(\d+)(?:\.(\d+))?)?(?:\W+Mobile\S*)?\W+Safari/}];for(const{key:t,pattern:n}of e){const e=n.exec(navigator.userAgent);if(e){const n=e[1]||0,r=e[2]||0,s=e[3]||0;return{browser:t,version:`${n}.${r}.${s}`}}}return null}const O=e=>"x32"===e?"x32":"x86_64"===e||"x64"===e?"x64":"arm"===e?"arm":"aarch64"===e||"arm64"===e?"arm64":e?`other:${e}`:"unknown",A=e=>(e=e.toLowerCase(),e.includes("ios")?"iOS":"android"===e?"Android":"darwin"===e?"MacOS":"win32"===e?"Windows":"freebsd"===e?"FreeBSD":"openbsd"===e?"OpenBSD":"linux"===e?"Linux":e?`Other:${e}`:"Unknown");let R;const I=()=>R??(R=v()),E=e=>{try{return JSON.parse(e)}catch(t){return}};t.safeJSON=E;const j=/^[a-z][a-z0-9+.-]*:/i,S=e=>j.test(e),C=e=>new Promise((t=>setTimeout(t,e)));t.sleep=C;const x=(e,t)=>{if("number"!==typeof t||!Number.isInteger(t))throw new c.OpenAIError(`${e} must be an integer`);if(t<0)throw new c.OpenAIError(`${e} must be a positive integer`);return t},M=e=>{if(e instanceof Error)return e;if("object"===typeof e&&null!==e)try{return new Error(JSON.stringify(e))}catch{}return new Error(e)};t.castToError=M;const F=e=>{if(null==e)throw new c.OpenAIError(`Expected a value to be given but received ${e} instead.`);return e};t.ensurePresent=F;const T=e=>"undefined"!==typeof process?{NODE_ENV:"production",BASE_URL:"/THChatUI/"}?.[e]?.trim()??void 0:"undefined"!==typeof Deno?Deno.env?.get?.(e)?.trim():void 0;t.readEnv=T;const k=e=>{if("number"===typeof e)return Math.round(e);if("string"===typeof e)return parseInt(e,10);throw new c.OpenAIError(`Could not coerce ${e} (type: ${typeof e}) into a number`)};t.coerceInteger=k;const $=e=>{if("number"===typeof e)return e;if("string"===typeof e)return parseFloat(e);throw new c.OpenAIError(`Could not coerce ${e} (type: ${typeof e}) into a number`)};t.coerceFloat=$;const B=e=>"boolean"===typeof e?e:"string"===typeof e?"true"===e:Boolean(e);t.coerceBoolean=B;const D=e=>{if(void 0!==e)return(0,t.coerceInteger)(e)};t.maybeCoerceInteger=D;const N=e=>{if(void 0!==e)return(0,t.coerceFloat)(e)};t.maybeCoerceFloat=N;const L=e=>{if(void 0!==e)return(0,t.coerceBoolean)(e)};function q(e){if(!e)return!0;for(const t in e)return!1;return!0}function U(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function V(e,t){for(const n in t){if(!U(t,n))continue;const r=n.toLowerCase();if(!r)continue;const s=t[n];null===s?delete e[r]:void 0!==s&&(e[r]=s)}}t.maybeCoerceBoolean=L,t.isEmptyObj=q,t.hasOwn=U;const W=new Set(["authorization","api-key"]);function J(e,...t){if("undefined"!==typeof process&&"true"==={NODE_ENV:"production",BASE_URL:"/THChatUI/"}?.["DEBUG"]){const n=t.map((e=>{if(!e)return e;if(e["headers"]){const t={...e,headers:{...e["headers"]}};for(const n in e["headers"])W.has(n.toLowerCase())&&(t["headers"][n]="REDACTED");return t}let t=null;for(const n in e)W.has(n.toLowerCase())&&(t??(t={...e}),t[n]="REDACTED");return t??e}));console.log(`OpenAI:DEBUG:${e}`,...n)}}t.debug=J;const H=()=>"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(e=>{const t=16*Math.random()|0,n="x"===e?t:3&t|8;return n.toString(16)})),X=()=>"undefined"!==typeof window&&"undefined"!==typeof window.document&&"undefined"!==typeof navigator;t.isRunningInBrowser=X;const K=e=>"function"===typeof e?.get;t.isHeadersProtocol=K;const z=(e,n)=>{const r=(0,t.getHeader)(e,n);if(void 0===r)throw new Error(`Could not find ${n} header`);return r};t.getRequiredHeader=z;const Q=(e,n)=>{const r=n.toLowerCase();if((0,t.isHeadersProtocol)(e)){const t=n[0]?.toUpperCase()+n.substring(1).replace(/([^\w])(\w)/g,((e,t,n)=>t+n.toUpperCase()));for(const s of[n,r,n.toUpperCase(),t]){const t=e.get(s);if(t)return t}}for(const[t,s]of Object.entries(e))if(t.toLowerCase()===r)return Array.isArray(s)?(s.length<=1||console.warn(`Received ${s.length} entries for the ${n} header, using the first entry.`),s[0]):s};t.getHeader=Q;const G=e=>{if(!e)return"";if("undefined"!==typeof Buffer)return Buffer.from(e).toString("base64");if("undefined"!==typeof btoa)return btoa(e);throw new c.OpenAIError("Cannot generate b64 string; Expected `Buffer` or `btoa` to be defined")};t.toBase64=G;const Y=e=>{if("undefined"!==typeof Buffer){const t=Buffer.from(e,"base64");return Array.from(new Float32Array(t.buffer,t.byteOffset,t.length/Float32Array.BYTES_PER_ELEMENT))}{const t=atob(e),n=t.length,r=new Uint8Array(n);for(let e=0;e<n;e++)r[e]=t.charCodeAt(e);return Array.from(new Float32Array(r.buffer))}};function Z(e){return null!=e&&"object"===typeof e&&!Array.isArray(e)}t.toFloat32Array=Y,t.isObj=Z},25701:function(e,t,n){"use strict";n(44114),Object.defineProperty(t,"__esModule",{value:!0}),t._iterSSEMessages=t.Stream=void 0;const r=n(86551),s=n(18815),o=n(41251),i=n(9347),a=n(25370),c=n(18815);class l{constructor(e,t){this.iterator=e,this.controller=t}static fromSSEResponse(e,t){let n=!1;async function*r(){if(n)throw new Error("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");n=!0;let r=!1;try{for await(const n of u(e,t))if(!r)if(n.data.startsWith("[DONE]"))r=!0;else if(null===n.event||n.event.startsWith("response.")||n.event.startsWith("transcript.")){let t;try{t=JSON.parse(n.data)}catch(s){throw console.error("Could not parse message into JSON:",n.data),console.error("From chunk:",n.raw),s}if(t&&t.error)throw new c.APIError(void 0,t.error,void 0,(0,a.createResponseHeaders)(e.headers));yield t}else{let e;try{e=JSON.parse(n.data)}catch(s){throw console.error("Could not parse message into JSON:",n.data),console.error("From chunk:",n.raw),s}if("error"==n.event)throw new c.APIError(void 0,e.error,e.message,void 0);yield{event:n.event,data:e}}r=!0}catch(s){if(s instanceof Error&&"AbortError"===s.name)return;throw s}finally{r||t.abort()}}return new l(r,t)}static fromReadableStream(e,t){let n=!1;async function*r(){const t=new o.LineDecoder,n=(0,i.ReadableStreamToAsyncIterable)(e);for await(const e of n)for(const n of t.decode(e))yield n;for(const e of t.flush())yield e}async function*s(){if(n)throw new Error("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");n=!0;let e=!1;try{for await(const t of r())e||t&&(yield JSON.parse(t));e=!0}catch(s){if(s instanceof Error&&"AbortError"===s.name)return;throw s}finally{e||t.abort()}}return new l(s,t)}[Symbol.asyncIterator](){return this.iterator()}tee(){const e=[],t=[],n=this.iterator(),r=r=>({next:()=>{if(0===r.length){const r=n.next();e.push(r),t.push(r)}return r.shift()}});return[new l((()=>r(e)),this.controller),new l((()=>r(t)),this.controller)]}toReadableStream(){const e=this;let t;const n=new TextEncoder;return new r.ReadableStream({async start(){t=e[Symbol.asyncIterator]()},async pull(e){try{const{value:r,done:s}=await t.next();if(s)return e.close();const o=n.encode(JSON.stringify(r)+"\n");e.enqueue(o)}catch(r){e.error(r)}},async cancel(){await(t.return?.())}})}}async function*u(e,t){if(!e.body)throw t.abort(),new s.OpenAIError("Attempted to iterate over a response with no body");const n=new f,r=new o.LineDecoder,a=(0,i.ReadableStreamToAsyncIterable)(e.body);for await(const s of d(a))for(const e of r.decode(s)){const t=n.decode(e);t&&(yield t)}for(const s of r.flush()){const e=n.decode(s);e&&(yield e)}}async function*d(e){let t=new Uint8Array;for await(const n of e){if(null==n)continue;const e=n instanceof ArrayBuffer?new Uint8Array(n):"string"===typeof n?(new TextEncoder).encode(n):n;let r,s=new Uint8Array(t.length+e.length);s.set(t),s.set(e,t.length),t=s;while(-1!==(r=(0,o.findDoubleNewlineIndex)(t)))yield t.slice(0,r),t=t.slice(r)}t.length>0&&(yield t)}t.Stream=l,t._iterSSEMessages=u;class f{constructor(){this.event=null,this.data=[],this.chunks=[]}decode(e){if(e.endsWith("\r")&&(e=e.substring(0,e.length-1)),!e){if(!this.event&&!this.data.length)return null;const e={event:this.event,data:this.data.join("\n"),raw:this.chunks};return this.event=null,this.data=[],this.chunks=[],e}if(this.chunks.push(e),e.startsWith(":"))return null;let[t,n,r]=h(e,":");return r.startsWith(" ")&&(r=r.substring(1)),"event"===t?this.event=r:"data"===t&&this.data.push(r),null}}function h(e,t){const n=e.indexOf(t);return-1!==n?[e.substring(0,n),t,e.substring(n+t.length)]:[e,"",""]}},26924:function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var s=Object.getOwnPropertyDescriptor(t,n);s&&!("get"in s?!t.__esModule:s.writable||s.configurable)||(s={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,s)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e["default"]=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return s(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.Uploads=void 0;const i=n(56497),a=o(n(25148)),c=n(25148);class l extends i.APIResource{constructor(){super(...arguments),this.parts=new a.Parts(this._client)}create(e,t){return this._client.post("/uploads",{body:e,...t})}cancel(e,t){return this._client.post(`/uploads/${e}/cancel`,t)}complete(e,t,n){return this._client.post(`/uploads/${e}/complete`,{body:t,...n})}}t.Uploads=l,l.Parts=c.Parts},29386:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MessagesPage=t.Messages=void 0;const r=n(56497),s=n(25370),o=n(84873);class i extends r.APIResource{create(e,t,n){return this._client.post(`/threads/${e}/messages`,{body:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}retrieve(e,t,n){return this._client.get(`/threads/${e}/messages/${t}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}update(e,t,n,r){return this._client.post(`/threads/${e}/messages/${t}`,{body:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r?.headers}})}list(e,t={},n){return(0,s.isRequestOptions)(t)?this.list(e,{},t):this._client.getAPIList(`/threads/${e}/messages`,a,{query:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}del(e,t,n){return this._client.delete(`/threads/${e}/messages/${t}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}}t.Messages=i;class a extends o.CursorPage{}t.MessagesPage=a,i.MessagesPage=a},29513:function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var s=Object.getOwnPropertyDescriptor(t,n);s&&!("get"in s?!t.__esModule:s.writable||s.configurable)||(s={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,s)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e["default"]=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return s(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.Transcriptions=void 0;const i=n(56497),a=o(n(25370));class c extends i.APIResource{create(e,t){return this._client.post("/audio/transcriptions",a.multipartFormRequestOptions({body:e,...t,stream:e.stream??!1,__metadata:{model:e.model}}))}}t.Transcriptions=c},30218:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Completions=t.ChatCompletionRunner=t.ChatCompletionStream=t.ParsingToolFunction=t.ParsingFunction=t.ChatCompletionStreamingRunner=void 0;const r=n(56497),s=n(36751),o=n(36107),i=n(88729),a=n(74178);var c=n(36107);Object.defineProperty(t,"ChatCompletionStreamingRunner",{enumerable:!0,get:function(){return c.ChatCompletionStreamingRunner}});var l=n(19700);Object.defineProperty(t,"ParsingFunction",{enumerable:!0,get:function(){return l.ParsingFunction}}),Object.defineProperty(t,"ParsingToolFunction",{enumerable:!0,get:function(){return l.ParsingToolFunction}});var u=n(88729);Object.defineProperty(t,"ChatCompletionStream",{enumerable:!0,get:function(){return u.ChatCompletionStream}});var d=n(36751);Object.defineProperty(t,"ChatCompletionRunner",{enumerable:!0,get:function(){return d.ChatCompletionRunner}});class f extends r.APIResource{parse(e,t){return(0,a.validateInputTools)(e.tools),this._client.chat.completions.create(e,{...t,headers:{...t?.headers,"X-Stainless-Helper-Method":"beta.chat.completions.parse"}})._thenUnwrap((t=>(0,a.parseChatCompletion)(t,e)))}runFunctions(e,t){return e.stream?o.ChatCompletionStreamingRunner.runFunctions(this._client,e,t):s.ChatCompletionRunner.runFunctions(this._client,e,t)}runTools(e,t){return e.stream?o.ChatCompletionStreamingRunner.runTools(this._client,e,t):s.ChatCompletionRunner.runTools(this._client,e,t)}stream(e,t){return i.ChatCompletionStream.createChatCompletion(this._client,e,t)}}t.Completions=f},32266:function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var s=Object.getOwnPropertyDescriptor(t,n);s&&!("get"in s?!t.__esModule:s.writable||s.configurable)||(s={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,s)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e["default"]=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return s(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.RunListResponsesPage=t.Runs=void 0;const i=n(56497),a=n(25370),c=o(n(1436)),l=n(1436),u=n(84873);class d extends i.APIResource{constructor(){super(...arguments),this.outputItems=new c.OutputItems(this._client)}create(e,t,n){return this._client.post(`/evals/${e}/runs`,{body:t,...n})}retrieve(e,t,n){return this._client.get(`/evals/${e}/runs/${t}`,n)}list(e,t={},n){return(0,a.isRequestOptions)(t)?this.list(e,{},t):this._client.getAPIList(`/evals/${e}/runs`,f,{query:t,...n})}del(e,t,n){return this._client.delete(`/evals/${e}/runs/${t}`,n)}cancel(e,t,n){return this._client.post(`/evals/${e}/runs/${t}`,n)}}t.Runs=d;class f extends u.CursorPage{}t.RunListResponsesPage=f,d.RunListResponsesPage=f,d.OutputItems=l.OutputItems,d.OutputItemListResponsesPage=l.OutputItemListResponsesPage},33372:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.formats=t.stringify=void 0;const r=n(55972),s={formatters:r.formatters,RFC1738:r.RFC1738,RFC3986:r.RFC3986,default:r.default_format};t.formats=s;var o=n(45297);Object.defineProperty(t,"stringify",{enumerable:!0,get:function(){return o.stringify}})},34925:function(e,t,n){"use strict";n(44114),n(18111),n(61701),n(13579);var r,s,o,i,a,c,l,u,d=this&&this.__classPrivateFieldGet||function(e,t,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"===typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(e):r?r.value:t.get(e)};Object.defineProperty(t,"__esModule",{value:!0}),t.AbstractChatCompletionRunner=void 0;const f=n(18815),h=n(19700),p=n(72360),m=n(20757),g=n(74178),b=10;class y extends m.EventStream{constructor(){super(...arguments),r.add(this),this._chatCompletions=[],this.messages=[]}_addChatCompletion(e){this._chatCompletions.push(e),this._emit("chatCompletion",e);const t=e.choices[0]?.message;return t&&this._addMessage(t),e}_addMessage(e,t=!0){if("content"in e||(e.content=null),this.messages.push(e),t)if(this._emit("message",e),((0,p.isFunctionMessage)(e)||(0,p.isToolMessage)(e))&&e.content)this._emit("functionCallResult",e.content);else if((0,p.isAssistantMessage)(e)&&e.function_call)this._emit("functionCall",e.function_call);else if((0,p.isAssistantMessage)(e)&&e.tool_calls)for(const n of e.tool_calls)"function"===n.type&&this._emit("functionCall",n.function)}async finalChatCompletion(){await this.done();const e=this._chatCompletions[this._chatCompletions.length-1];if(!e)throw new f.OpenAIError("stream ended without producing a ChatCompletion");return e}async finalContent(){return await this.done(),d(this,r,"m",s).call(this)}async finalMessage(){return await this.done(),d(this,r,"m",o).call(this)}async finalFunctionCall(){return await this.done(),d(this,r,"m",i).call(this)}async finalFunctionCallResult(){return await this.done(),d(this,r,"m",a).call(this)}async totalUsage(){return await this.done(),d(this,r,"m",c).call(this)}allChatCompletions(){return[...this._chatCompletions]}_emitFinal(){const e=this._chatCompletions[this._chatCompletions.length-1];e&&this._emit("finalChatCompletion",e);const t=d(this,r,"m",o).call(this);t&&this._emit("finalMessage",t);const n=d(this,r,"m",s).call(this);n&&this._emit("finalContent",n);const l=d(this,r,"m",i).call(this);l&&this._emit("finalFunctionCall",l);const u=d(this,r,"m",a).call(this);null!=u&&this._emit("finalFunctionCallResult",u),this._chatCompletions.some((e=>e.usage))&&this._emit("totalUsage",d(this,r,"m",c).call(this))}async _createChatCompletion(e,t,n){const s=n?.signal;s&&(s.aborted&&this.controller.abort(),s.addEventListener("abort",(()=>this.controller.abort()))),d(this,r,"m",l).call(this,t);const o=await e.chat.completions.create({...t,stream:!1},{...n,signal:this.controller.signal});return this._connected(),this._addChatCompletion((0,g.parseChatCompletion)(o,t))}async _runChatCompletion(e,t,n){for(const r of t.messages)this._addMessage(r,!1);return await this._createChatCompletion(e,t,n)}async _runFunctions(e,t,n){const s="function",{function_call:o="auto",stream:i,...a}=t,c="string"!==typeof o&&o?.name,{maxChatCompletions:l=b}=n||{},p={};for(const r of t.functions)p[r.name||r.function.name]=r;const m=t.functions.map((e=>({name:e.name||e.function.name,parameters:e.parameters,description:e.description})));for(const r of t.messages)this._addMessage(r,!1);for(let b=0;b<l;++b){const t=await this._createChatCompletion(e,{...a,function_call:o,functions:m,messages:[...this.messages]},n),i=t.choices[0]?.message;if(!i)throw new f.OpenAIError("missing message in ChatCompletion response");if(!i.function_call)return;const{name:l,arguments:b}=i.function_call,y=p[l];if(!y){const e=`Invalid function_call: ${JSON.stringify(l)}. Available options are: ${m.map((e=>JSON.stringify(e.name))).join(", ")}. Please try again`;this._addMessage({role:s,name:l,content:e});continue}if(c&&c!==l){const e=`Invalid function_call: ${JSON.stringify(l)}. ${JSON.stringify(c)} requested. Please try again`;this._addMessage({role:s,name:l,content:e});continue}let _;try{_=(0,h.isRunnableFunctionWithParse)(y)?await y.parse(b):b}catch(g){this._addMessage({role:s,name:l,content:g instanceof Error?g.message:String(g)});continue}const w=await y.function(_,this),v=d(this,r,"m",u).call(this,w);if(this._addMessage({role:s,name:l,content:v}),c)return}}async _runTools(e,t,n){const s="tool",{tool_choice:o="auto",stream:i,...a}=t,c="string"!==typeof o&&o?.function?.name,{maxChatCompletions:l=b}=n||{},p=t.tools.map((e=>{if((0,g.isAutoParsableTool)(e)){if(!e.$callback)throw new f.OpenAIError("Tool given to `.runTools()` that does not have an associated function");return{type:"function",function:{function:e.$callback,name:e.function.name,description:e.function.description||"",parameters:e.function.parameters,parse:e.$parseRaw,strict:!0}}}return e})),m={};for(const r of p)"function"===r.type&&(m[r.function.name||r.function.function.name]=r.function);const y="tools"in t?p.map((e=>"function"===e.type?{type:"function",function:{name:e.function.name||e.function.function.name,parameters:e.function.parameters,description:e.function.description,strict:e.function.strict}}:e)):void 0;for(const r of t.messages)this._addMessage(r,!1);for(let g=0;g<l;++g){const t=await this._createChatCompletion(e,{...a,tool_choice:o,tools:y,messages:[...this.messages]},n),i=t.choices[0]?.message;if(!i)throw new f.OpenAIError("missing message in ChatCompletion response");if(!i.tool_calls?.length)return;for(const e of i.tool_calls){if("function"!==e.type)continue;const t=e.id,{name:n,arguments:o}=e.function,i=m[n];if(!i){const e=`Invalid tool_call: ${JSON.stringify(n)}. Available options are: ${Object.keys(m).map((e=>JSON.stringify(e))).join(", ")}. Please try again`;this._addMessage({role:s,tool_call_id:t,content:e});continue}if(c&&c!==n){const e=`Invalid tool_call: ${JSON.stringify(n)}. ${JSON.stringify(c)} requested. Please try again`;this._addMessage({role:s,tool_call_id:t,content:e});continue}let a;try{a=(0,h.isRunnableFunctionWithParse)(i)?await i.parse(o):o}catch(_){const e=_ instanceof Error?_.message:String(_);this._addMessage({role:s,tool_call_id:t,content:e});continue}const l=await i.function(a,this),f=d(this,r,"m",u).call(this,l);if(this._addMessage({role:s,tool_call_id:t,content:f}),c)return}}}}t.AbstractChatCompletionRunner=y,r=new WeakSet,s=function(){return d(this,r,"m",o).call(this).content??null},o=function(){let e=this.messages.length;while(e-- >0){const t=this.messages[e];if((0,p.isAssistantMessage)(t)){const{function_call:e,...n}=t,r={...n,content:t.content??null,refusal:t.refusal??null};return e&&(r.function_call=e),r}}throw new f.OpenAIError("stream ended without producing a ChatCompletionMessage with role=assistant")},i=function(){for(let e=this.messages.length-1;e>=0;e--){const t=this.messages[e];if((0,p.isAssistantMessage)(t)&&t?.function_call)return t.function_call;if((0,p.isAssistantMessage)(t)&&t?.tool_calls?.length)return t.tool_calls.at(-1)?.function}},a=function(){for(let e=this.messages.length-1;e>=0;e--){const t=this.messages[e];if((0,p.isFunctionMessage)(t)&&null!=t.content)return t.content;if((0,p.isToolMessage)(t)&&null!=t.content&&"string"===typeof t.content&&this.messages.some((e=>"assistant"===e.role&&e.tool_calls?.some((e=>"function"===e.type&&e.id===t.tool_call_id)))))return t.content}},c=function(){const e={completion_tokens:0,prompt_tokens:0,total_tokens:0};for(const{usage:t}of this._chatCompletions)t&&(e.completion_tokens+=t.completion_tokens,e.prompt_tokens+=t.prompt_tokens,e.total_tokens+=t.total_tokens);return e},l=function(e){if(null!=e.n&&e.n>1)throw new f.OpenAIError("ChatCompletion convenience helpers only support n=1 at this time. To use n>1, please use chat.completions.create() directly.")},u=function(e){return"string"===typeof e?e:void 0===e?"undefined":JSON.stringify(e)}},36107:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ChatCompletionStreamingRunner=void 0;const r=n(88729);class s extends r.ChatCompletionStream{static fromReadableStream(e){const t=new s(null);return t._run((()=>t._fromReadableStream(e))),t}static runFunctions(e,t,n){const r=new s(null),o={...n,headers:{...n?.headers,"X-Stainless-Helper-Method":"runFunctions"}};return r._run((()=>r._runFunctions(e,t,o))),r}static runTools(e,t,n){const r=new s(t),o={...n,headers:{...n?.headers,"X-Stainless-Helper-Method":"runTools"}};return r._run((()=>r._runTools(e,t,o))),r}}t.ChatCompletionStreamingRunner=s},36751:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ChatCompletionRunner=void 0;const r=n(34925),s=n(72360);class o extends r.AbstractChatCompletionRunner{static runFunctions(e,t,n){const r=new o,s={...n,headers:{...n?.headers,"X-Stainless-Helper-Method":"runFunctions"}};return r._run((()=>r._runFunctions(e,t,s))),r}static runTools(e,t,n){const r=new o,s={...n,headers:{...n?.headers,"X-Stainless-Helper-Method":"runTools"}};return r._run((()=>r._runTools(e,t,s))),r}_addMessage(e,t=!0){super._addMessage(e,t),(0,s.isAssistantMessage)(e)&&e.content&&this._emit("content",e.content)}}t.ChatCompletionRunner=o},38365:function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var s=Object.getOwnPropertyDescriptor(t,n);s&&!("get"in s?!t.__esModule:s.writable||s.configurable)||(s={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,s)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e["default"]=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return s(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.Images=void 0;const i=n(56497),a=o(n(25370));class c extends i.APIResource{createVariation(e,t){return this._client.post("/images/variations",a.multipartFormRequestOptions({body:e,...t}))}edit(e,t){return this._client.post("/images/edits",a.multipartFormRequestOptions({body:e,...t}))}generate(e,t){return this._client.post("/images/generations",{body:e,...t})}}t.Images=c},38827:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FileContentResponsesPage=t.VectorStoreFilesPage=t.Files=void 0;const r=n(56497),s=n(25370),o=n(84873);class i extends r.APIResource{create(e,t,n){return this._client.post(`/vector_stores/${e}/files`,{body:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}retrieve(e,t,n){return this._client.get(`/vector_stores/${e}/files/${t}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}update(e,t,n,r){return this._client.post(`/vector_stores/${e}/files/${t}`,{body:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r?.headers}})}list(e,t={},n){return(0,s.isRequestOptions)(t)?this.list(e,{},t):this._client.getAPIList(`/vector_stores/${e}/files`,a,{query:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}del(e,t,n){return this._client.delete(`/vector_stores/${e}/files/${t}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}async createAndPoll(e,t,n){const r=await this.create(e,t,n);return await this.poll(e,r.id,n)}async poll(e,t,n){const r={...n?.headers,"X-Stainless-Poll-Helper":"true"};n?.pollIntervalMs&&(r["X-Stainless-Custom-Poll-Interval"]=n.pollIntervalMs.toString());while(1){const o=await this.retrieve(e,t,{...n,headers:r}).withResponse(),i=o.data;switch(i.status){case"in_progress":let e=5e3;if(n?.pollIntervalMs)e=n.pollIntervalMs;else{const t=o.response.headers.get("openai-poll-after-ms");if(t){const n=parseInt(t);isNaN(n)||(e=n)}}await(0,s.sleep)(e);break;case"failed":case"completed":return i}}}async upload(e,t,n){const r=await this._client.files.create({file:t,purpose:"assistants"},n);return this.create(e,{file_id:r.id},n)}async uploadAndPoll(e,t,n){const r=await this.upload(e,t,n);return await this.poll(e,r.id,n)}content(e,t,n){return this._client.getAPIList(`/vector_stores/${e}/files/${t}/content`,c,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}}t.Files=i;class a extends o.CursorPage{}t.VectorStoreFilesPage=a;class c extends o.Page{}t.FileContentResponsesPage=c,i.VectorStoreFilesPage=a,i.FileContentResponsesPage=c},39960:function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var s=Object.getOwnPropertyDescriptor(t,n);s&&!("get"in s?!t.__esModule:s.writable||s.configurable)||(s={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,s)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e["default"]=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return s(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.Audio=void 0;const i=n(56497),a=o(n(48218)),c=n(48218),l=o(n(29513)),u=n(29513),d=o(n(15364)),f=n(15364);class h extends i.APIResource{constructor(){super(...arguments),this.transcriptions=new l.Transcriptions(this._client),this.translations=new d.Translations(this._client),this.speech=new a.Speech(this._client)}}t.Audio=h,h.Transcriptions=u.Transcriptions,h.Translations=f.Translations,h.Speech=c.Speech},41251:function(e,t,n){"use strict";n(44114),n(17642),n(58004),n(33853),n(45876),n(32475),n(15024),n(31698);var r,s=this&&this.__classPrivateFieldSet||function(e,t,n,r,s){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!s)throw new TypeError("Private accessor was defined without a setter");if("function"===typeof t?e!==t||!s:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?s.call(e,n):s?s.value=n:t.set(e,n),n},o=this&&this.__classPrivateFieldGet||function(e,t,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"===typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(e):r?r.value:t.get(e)};Object.defineProperty(t,"__esModule",{value:!0}),t.findDoubleNewlineIndex=t.LineDecoder=void 0;const i=n(18815);class a{constructor(){r.set(this,void 0),this.buffer=new Uint8Array,s(this,r,null,"f")}decode(e){if(null==e)return[];const t=e instanceof ArrayBuffer?new Uint8Array(e):"string"===typeof e?(new TextEncoder).encode(e):e;let n=new Uint8Array(this.buffer.length+t.length);n.set(this.buffer),n.set(t,this.buffer.length),this.buffer=n;const i=[];let a;while(null!=(a=c(this.buffer,o(this,r,"f")))){if(a.carriage&&null==o(this,r,"f")){s(this,r,a.index,"f");continue}if(null!=o(this,r,"f")&&(a.index!==o(this,r,"f")+1||a.carriage)){i.push(this.decodeText(this.buffer.slice(0,o(this,r,"f")-1))),this.buffer=this.buffer.slice(o(this,r,"f")),s(this,r,null,"f");continue}const e=null!==o(this,r,"f")?a.preceding-1:a.preceding,t=this.decodeText(this.buffer.slice(0,e));i.push(t),this.buffer=this.buffer.slice(a.index),s(this,r,null,"f")}return i}decodeText(e){if(null==e)return"";if("string"===typeof e)return e;if("undefined"!==typeof Buffer){if(e instanceof Buffer)return e.toString();if(e instanceof Uint8Array)return Buffer.from(e).toString();throw new i.OpenAIError(`Unexpected: received non-Uint8Array (${e.constructor.name}) stream chunk in an environment with a global "Buffer" defined, which this library assumes to be Node. Please report this error.`)}if("undefined"!==typeof TextDecoder){if(e instanceof Uint8Array||e instanceof ArrayBuffer)return this.textDecoder??(this.textDecoder=new TextDecoder("utf8")),this.textDecoder.decode(e);throw new i.OpenAIError(`Unexpected: received non-Uint8Array/ArrayBuffer (${e.constructor.name}) in a web platform. Please report this error.`)}throw new i.OpenAIError("Unexpected: neither Buffer nor TextDecoder are available as globals. Please report this error.")}flush(){return this.buffer.length?this.decode("\n"):[]}}function c(e,t){const n=10,r=13;for(let s=t??0;s<e.length;s++){if(e[s]===n)return{preceding:s,index:s+1,carriage:!1};if(e[s]===r)return{preceding:s,index:s+1,carriage:!0}}return null}function l(e){const t=10,n=13;for(let r=0;r<e.length-1;r++){if(e[r]===t&&e[r+1]===t)return r+2;if(e[r]===n&&e[r+1]===n)return r+2;if(e[r]===n&&e[r+1]===t&&r+3<e.length&&e[r+2]===n&&e[r+3]===t)return r+4}return-1}t.LineDecoder=a,r=new WeakMap,a.NEWLINE_CHARS=new Set(["\n","\r"]),a.NEWLINE_REGEXP=/\r\n|[\n\r]/g,t.findDoubleNewlineIndex=l},43254:function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var s=Object.getOwnPropertyDescriptor(t,n);s&&!("get"in s?!t.__esModule:s.writable||s.configurable)||(s={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,s)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e["default"]=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return s(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.Beta=void 0;const i=n(56497),a=o(n(71173)),c=o(n(74427)),l=n(71173),u=o(n(58893)),d=n(58893),f=o(n(56725)),h=n(56725);n(74427);class p extends i.APIResource{constructor(){super(...arguments),this.realtime=new u.Realtime(this._client),this.chat=new c.Chat(this._client),this.assistants=new a.Assistants(this._client),this.threads=new f.Threads(this._client)}}t.Beta=p,p.Realtime=d.Realtime,p.Assistants=l.Assistants,p.AssistantsPage=l.AssistantsPage,p.Threads=h.Threads},45152:function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var s=Object.getOwnPropertyDescriptor(t,n);s&&!("get"in s?!t.__esModule:s.writable||s.configurable)||(s={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,s)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e["default"]=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return s(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.FineTuning=void 0;const i=n(56497),a=o(n(69493)),c=n(69493),l=o(n(70007)),u=n(70007);class d extends i.APIResource{constructor(){super(...arguments),this.jobs=new l.Jobs(this._client),this.checkpoints=new a.Checkpoints(this._client)}}t.FineTuning=d,d.Jobs=u.Jobs,d.FineTuningJobsPage=u.FineTuningJobsPage,d.FineTuningJobEventsPage=u.FineTuningJobEventsPage,d.Checkpoints=c.Checkpoints},45297:function(e,t,n){"use strict";n(44114),n(18111),n(22489),Object.defineProperty(t,"__esModule",{value:!0}),t.stringify=void 0;const r=n(11413),s=n(55972),o=Object.prototype.hasOwnProperty,i={brackets(e){return String(e)+"[]"},comma:"comma",indices(e,t){return String(e)+"["+t+"]"},repeat(e){return String(e)}},a=Array.isArray,c=Array.prototype.push,l=function(e,t){c.apply(e,a(t)?t:[t])},u=Date.prototype.toISOString,d={addQueryPrefix:!1,allowDots:!1,allowEmptyArrays:!1,arrayFormat:"indices",charset:"utf-8",charsetSentinel:!1,delimiter:"&",encode:!0,encodeDotInKeys:!1,encoder:r.encode,encodeValuesOnly:!1,format:s.default_format,formatter:s.formatters[s.default_format],indices:!1,serializeDate(e){return u.call(e)},skipNulls:!1,strictNullHandling:!1};function f(e){return"string"===typeof e||"number"===typeof e||"boolean"===typeof e||"symbol"===typeof e||"bigint"===typeof e}const h={};function p(e,t,n,s,o,i,c,u,m,g,b,y,_,w,v,P,O,A){let R=e,I=A,E=0,j=!1;while(void 0!==(I=I.get(h))&&!j){const t=I.get(e);if(E+=1,"undefined"!==typeof t){if(t===E)throw new RangeError("Cyclic object value");j=!0}"undefined"===typeof I.get(h)&&(E=0)}if("function"===typeof g?R=g(t,R):R instanceof Date?R=_?.(R):"comma"===n&&a(R)&&(R=(0,r.maybe_map)(R,(function(e){return e instanceof Date?_?.(e):e}))),null===R){if(i)return m&&!P?m(t,d.encoder,O,"key",w):t;R=""}if(f(R)||(0,r.is_buffer)(R)){if(m){const e=P?t:m(t,d.encoder,O,"key",w);return[v?.(e)+"="+v?.(m(R,d.encoder,O,"value",w))]}return[v?.(t)+"="+v?.(String(R))]}const S=[];if("undefined"===typeof R)return S;let C;if("comma"===n&&a(R))P&&m&&(R=(0,r.maybe_map)(R,m)),C=[{value:R.length>0?R.join(",")||null:void 0}];else if(a(g))C=g;else{const e=Object.keys(R);C=b?e.sort(b):e}const x=u?String(t).replace(/\./g,"%2E"):String(t),M=s&&a(R)&&1===R.length?x+"[]":x;if(o&&a(R)&&0===R.length)return M+"[]";for(let r=0;r<C.length;++r){const t=C[r],d="object"===typeof t&&"undefined"!==typeof t.value?t.value:R[t];if(c&&null===d)continue;const f=y&&u?t.replace(/\./g,"%2E"):t,I=a(R)?"function"===typeof n?n(M,f):M:M+(y?"."+f:"["+f+"]");A.set(e,E);const j=new WeakMap;j.set(h,A),l(S,p(d,I,n,s,o,i,c,u,"comma"===n&&P&&a(R)?null:m,g,b,y,_,w,v,P,O,j))}return S}function m(e=d){if("undefined"!==typeof e.allowEmptyArrays&&"boolean"!==typeof e.allowEmptyArrays)throw new TypeError("`allowEmptyArrays` option can only be `true` or `false`, when provided");if("undefined"!==typeof e.encodeDotInKeys&&"boolean"!==typeof e.encodeDotInKeys)throw new TypeError("`encodeDotInKeys` option can only be `true` or `false`, when provided");if(null!==e.encoder&&"undefined"!==typeof e.encoder&&"function"!==typeof e.encoder)throw new TypeError("Encoder has to be a function.");const t=e.charset||d.charset;if("undefined"!==typeof e.charset&&"utf-8"!==e.charset&&"iso-8859-1"!==e.charset)throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");let n=s.default_format;if("undefined"!==typeof e.format){if(!o.call(s.formatters,e.format))throw new TypeError("Unknown format option provided.");n=e.format}const r=s.formatters[n];let c,l=d.filter;if(("function"===typeof e.filter||a(e.filter))&&(l=e.filter),c=e.arrayFormat&&e.arrayFormat in i?e.arrayFormat:"indices"in e?e.indices?"indices":"repeat":d.arrayFormat,"commaRoundTrip"in e&&"boolean"!==typeof e.commaRoundTrip)throw new TypeError("`commaRoundTrip` must be a boolean, or absent");const u="undefined"===typeof e.allowDots?!0===!!e.encodeDotInKeys||d.allowDots:!!e.allowDots;return{addQueryPrefix:"boolean"===typeof e.addQueryPrefix?e.addQueryPrefix:d.addQueryPrefix,allowDots:u,allowEmptyArrays:"boolean"===typeof e.allowEmptyArrays?!!e.allowEmptyArrays:d.allowEmptyArrays,arrayFormat:c,charset:t,charsetSentinel:"boolean"===typeof e.charsetSentinel?e.charsetSentinel:d.charsetSentinel,commaRoundTrip:!!e.commaRoundTrip,delimiter:"undefined"===typeof e.delimiter?d.delimiter:e.delimiter,encode:"boolean"===typeof e.encode?e.encode:d.encode,encodeDotInKeys:"boolean"===typeof e.encodeDotInKeys?e.encodeDotInKeys:d.encodeDotInKeys,encoder:"function"===typeof e.encoder?e.encoder:d.encoder,encodeValuesOnly:"boolean"===typeof e.encodeValuesOnly?e.encodeValuesOnly:d.encodeValuesOnly,filter:l,format:n,formatter:r,serializeDate:"function"===typeof e.serializeDate?e.serializeDate:d.serializeDate,skipNulls:"boolean"===typeof e.skipNulls?e.skipNulls:d.skipNulls,sort:"function"===typeof e.sort?e.sort:null,strictNullHandling:"boolean"===typeof e.strictNullHandling?e.strictNullHandling:d.strictNullHandling}}function g(e,t={}){let n=e;const r=m(t);let s,o;"function"===typeof r.filter?(o=r.filter,n=o("",n)):a(r.filter)&&(o=r.filter,s=o);const c=[];if("object"!==typeof n||null===n)return"";const u=i[r.arrayFormat],d="comma"===u&&r.commaRoundTrip;s||(s=Object.keys(n)),r.sort&&s.sort(r.sort);const f=new WeakMap;for(let i=0;i<s.length;++i){const e=s[i];r.skipNulls&&null===n[e]||l(c,p(n[e],e,u,d,r.allowEmptyArrays,r.strictNullHandling,r.skipNulls,r.encodeDotInKeys,r.encode?r.encoder:null,r.filter,r.sort,r.allowDots,r.serializeDate,r.format,r.formatter,r.encodeValuesOnly,r.charset,f))}const h=c.join(r.delimiter);let g=!0===r.addQueryPrefix?"?":"";return r.charsetSentinel&&("iso-8859-1"===r.charset?g+="utf8=%26%2310003%3B&":g+="utf8=%E2%9C%93&"),h.length>0?g+h:""}t.stringify=g},46630:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},48218:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Speech=void 0;const r=n(56497);class s extends r.APIResource{create(e,t){return this._client.post("/audio/speech",{body:e,...t,headers:{Accept:"application/octet-stream",...t?.headers},__binaryResponse:!0})}}t.Speech=s},50033:function(e,t,n){"use strict";n(44114),Object.defineProperty(t,"__esModule",{value:!0}),t.MalformedJSON=t.PartialJSON=t.partialParse=void 0;const r=1,s=2,o=4,i=8,a=16,c=32,l=64,u=128,d=256,f=u|d,h=a|c|f|l,p=r|s|h,m=o|i,g=p|m,b={STR:r,NUM:s,ARR:o,OBJ:i,NULL:a,BOOL:c,NAN:l,INFINITY:u,MINUS_INFINITY:d,INF:f,SPECIAL:h,ATOM:p,COLLECTION:m,ALL:g};class y extends Error{}t.PartialJSON=y;class _ extends Error{}function w(e,t=b.ALL){if("string"!==typeof e)throw new TypeError("expecting str, got "+typeof e);if(!e.trim())throw new Error(`${e} is empty`);return v(e.trim(),t)}t.MalformedJSON=_;const v=(e,t)=>{const n=e.length;let r=0;const s=e=>{throw new y(`${e} at position ${r}`)},o=e=>{throw new _(`${e} at position ${r}`)},i=()=>(d(),r>=n&&s("Unexpected end of input"),'"'===e[r]?a():"{"===e[r]?c():"["===e[r]?l():"null"===e.substring(r,r+4)||b.NULL&t&&n-r<4&&"null".startsWith(e.substring(r))?(r+=4,null):"true"===e.substring(r,r+4)||b.BOOL&t&&n-r<4&&"true".startsWith(e.substring(r))?(r+=4,!0):"false"===e.substring(r,r+5)||b.BOOL&t&&n-r<5&&"false".startsWith(e.substring(r))?(r+=5,!1):"Infinity"===e.substring(r,r+8)||b.INFINITY&t&&n-r<8&&"Infinity".startsWith(e.substring(r))?(r+=8,1/0):"-Infinity"===e.substring(r,r+9)||b.MINUS_INFINITY&t&&1<n-r&&n-r<9&&"-Infinity".startsWith(e.substring(r))?(r+=9,-1/0):"NaN"===e.substring(r,r+3)||b.NAN&t&&n-r<3&&"NaN".startsWith(e.substring(r))?(r+=3,NaN):u()),a=()=>{const i=r;let a=!1;r++;while(r<n&&('"'!==e[r]||a&&"\\"===e[r-1]))a="\\"===e[r]&&!a,r++;if('"'==e.charAt(r))try{return JSON.parse(e.substring(i,++r-Number(a)))}catch(c){o(String(c))}else if(b.STR&t)try{return JSON.parse(e.substring(i,r-Number(a))+'"')}catch(c){return JSON.parse(e.substring(i,e.lastIndexOf("\\"))+'"')}s("Unterminated string literal")},c=()=>{r++,d();const o={};try{while("}"!==e[r]){if(d(),r>=n&&b.OBJ&t)return o;const s=a();d(),r++;try{const e=i();Object.defineProperty(o,s,{value:e,writable:!0,enumerable:!0,configurable:!0})}catch(c){if(b.OBJ&t)return o;throw c}d(),","===e[r]&&r++}}catch(c){if(b.OBJ&t)return o;s("Expected '}' at end of object")}return r++,o},l=()=>{r++;const n=[];try{while("]"!==e[r])n.push(i()),d(),","===e[r]&&r++}catch(o){if(b.ARR&t)return n;s("Expected ']' at end of array")}return r++,n},u=()=>{if(0===r){"-"===e&&b.NUM&t&&s("Not sure what '-' is");try{return JSON.parse(e)}catch(a){if(b.NUM&t)try{return"."===e[e.length-1]?JSON.parse(e.substring(0,e.lastIndexOf("."))):JSON.parse(e.substring(0,e.lastIndexOf("e")))}catch(a){}o(String(a))}}const i=r;"-"===e[r]&&r++;while(e[r]&&!",]}".includes(e[r]))r++;r!=n||b.NUM&t||s("Unterminated number literal");try{return JSON.parse(e.substring(i,r))}catch(a){"-"===e.substring(i,r)&&b.NUM&t&&s("Not sure what '-' is");try{return JSON.parse(e.substring(i,e.lastIndexOf("e")))}catch(a){o(String(a))}}},d=()=>{while(r<n&&" \n\r\t".includes(e[r]))r++};return i()},P=e=>w(e,b.ALL^b.NUM);t.partialParse=P},51701:function(e,t,n){"use strict";n(17642),n(58004),n(33853),n(45876),n(32475),n(15024),n(31698);var r,s=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var s=Object.getOwnPropertyDescriptor(t,n);s&&!("get"in s?!t.__esModule:s.writable||s.configurable)||(s={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,s)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e["default"]=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&s(t,e,n);return o(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.UnprocessableEntityError=t.PermissionDeniedError=t.InternalServerError=t.AuthenticationError=t.BadRequestError=t.RateLimitError=t.ConflictError=t.NotFoundError=t.APIUserAbortError=t.APIConnectionTimeoutError=t.APIConnectionError=t.APIError=t.OpenAIError=t.fileFromPath=t.toFile=t.AzureOpenAI=t.OpenAI=void 0;const a=i(n(33372)),c=i(n(25370)),l=i(n(18815)),u=(i(n(84873)),i(n(78999))),d=i(n(98107)),f=n(66947),h=n(87148),p=n(88653),m=n(22836),g=n(38365),b=n(77661),y=n(20690),_=n(39960),w=n(43254),v=n(23406),P=n(964),O=n(45152),A=n(76632),R=n(26924),I=n(3448),E=n(63625);class j extends c.APIClient{constructor({baseURL:e=c.readEnv("OPENAI_BASE_URL"),apiKey:t=c.readEnv("OPENAI_API_KEY"),organization:n=c.readEnv("OPENAI_ORG_ID")??null,project:r=c.readEnv("OPENAI_PROJECT_ID")??null,...s}={}){if(void 0===t)throw new l.OpenAIError("The OPENAI_API_KEY environment variable is missing or empty; either provide it, or instantiate the OpenAI client with an apiKey option, like new OpenAI({ apiKey: 'My API Key' }).");const o={apiKey:t,organization:n,project:r,...s,baseURL:e||"https://api.openai.com/v1"};if(!o.dangerouslyAllowBrowser&&c.isRunningInBrowser())throw new l.OpenAIError("It looks like you're running in a browser-like environment.\n\nThis is disabled by default, as it risks exposing your secret API credentials to attackers.\nIf you understand the risks and have appropriate mitigations in place,\nyou can set the `dangerouslyAllowBrowser` option to `true`, e.g.,\n\nnew OpenAI({ apiKey, dangerouslyAllowBrowser: true });\n\nhttps://help.openai.com/en/articles/5112595-best-practices-for-api-key-safety\n");super({baseURL:o.baseURL,timeout:o.timeout??6e5,httpAgent:o.httpAgent,maxRetries:o.maxRetries,fetch:o.fetch}),this.completions=new d.Completions(this),this.chat=new d.Chat(this),this.embeddings=new d.Embeddings(this),this.files=new d.Files(this),this.images=new d.Images(this),this.audio=new d.Audio(this),this.moderations=new d.Moderations(this),this.models=new d.Models(this),this.fineTuning=new d.FineTuning(this),this.vectorStores=new d.VectorStores(this),this.beta=new d.Beta(this),this.batches=new d.Batches(this),this.uploads=new d.Uploads(this),this.responses=new d.Responses(this),this.evals=new d.Evals(this),this._options=o,this.apiKey=t,this.organization=n,this.project=r}defaultQuery(){return this._options.defaultQuery}defaultHeaders(e){return{...super.defaultHeaders(e),"OpenAI-Organization":this.organization,"OpenAI-Project":this.project,...this._options.defaultHeaders}}authHeaders(e){return{Authorization:`Bearer ${this.apiKey}`}}stringifyQuery(e){return a.stringify(e,{arrayFormat:"brackets"})}}t.OpenAI=j,r=j,j.OpenAI=r,j.DEFAULT_TIMEOUT=6e5,j.OpenAIError=l.OpenAIError,j.APIError=l.APIError,j.APIConnectionError=l.APIConnectionError,j.APIConnectionTimeoutError=l.APIConnectionTimeoutError,j.APIUserAbortError=l.APIUserAbortError,j.NotFoundError=l.NotFoundError,j.ConflictError=l.ConflictError,j.RateLimitError=l.RateLimitError,j.BadRequestError=l.BadRequestError,j.AuthenticationError=l.AuthenticationError,j.InternalServerError=l.InternalServerError,j.PermissionDeniedError=l.PermissionDeniedError,j.UnprocessableEntityError=l.UnprocessableEntityError,j.toFile=u.toFile,j.fileFromPath=u.fileFromPath,j.Completions=h.Completions,j.Chat=v.Chat,j.ChatCompletionsPage=E.ChatCompletionsPage,j.Embeddings=p.Embeddings,j.Files=m.Files,j.FileObjectsPage=m.FileObjectsPage,j.Images=g.Images,j.Audio=_.Audio,j.Moderations=y.Moderations,j.Models=b.Models,j.ModelsPage=b.ModelsPage,j.FineTuning=O.FineTuning,j.VectorStores=I.VectorStores,j.VectorStoresPage=I.VectorStoresPage,j.VectorStoreSearchResponsesPage=I.VectorStoreSearchResponsesPage,j.Beta=w.Beta,j.Batches=f.Batches,j.BatchesPage=f.BatchesPage,j.Uploads=R.Uploads,j.Responses=A.Responses,j.Evals=P.Evals,j.EvalListResponsesPage=P.EvalListResponsesPage;class S extends j{constructor({baseURL:e=c.readEnv("OPENAI_BASE_URL"),apiKey:t=c.readEnv("AZURE_OPENAI_API_KEY"),apiVersion:n=c.readEnv("OPENAI_API_VERSION"),endpoint:r,deployment:s,azureADTokenProvider:o,dangerouslyAllowBrowser:i,...a}={}){if(!n)throw new l.OpenAIError("The OPENAI_API_VERSION environment variable is missing or empty; either provide it, or instantiate the AzureOpenAI client with an apiVersion option, like new AzureOpenAI({ apiVersion: 'My API Version' }).");if("function"===typeof o&&(i=!0),!o&&!t)throw new l.OpenAIError("Missing credentials. Please pass one of `apiKey` and `azureADTokenProvider`, or set the `AZURE_OPENAI_API_KEY` environment variable.");if(o&&t)throw new l.OpenAIError("The `apiKey` and `azureADTokenProvider` arguments are mutually exclusive; only one can be passed at a time.");if(t??(t=x),a.defaultQuery={...a.defaultQuery,"api-version":n},e){if(r)throw new l.OpenAIError("baseURL and endpoint are mutually exclusive")}else{if(r||(r={NODE_ENV:"production",BASE_URL:"/THChatUI/"}["AZURE_OPENAI_ENDPOINT"]),!r)throw new l.OpenAIError("Must provide one of the `baseURL` or `endpoint` arguments, or the `AZURE_OPENAI_ENDPOINT` environment variable");e=`${r}/openai`}super({apiKey:t,baseURL:e,...a,...void 0!==i?{dangerouslyAllowBrowser:i}:{}}),this.apiVersion="",this._azureADTokenProvider=o,this.apiVersion=n,this.deploymentName=s}buildRequest(e,t={}){if(C.has(e.path)&&"post"===e.method&&void 0!==e.body){if(!c.isObj(e.body))throw new Error("Expected request body to be an object");const t=this.deploymentName||e.body["model"]||e.__metadata?.["model"];void 0===t||this.baseURL.includes("/deployments")||(e.path=`/deployments/${t}${e.path}`)}return super.buildRequest(e,t)}async _getAzureADToken(){if("function"===typeof this._azureADTokenProvider){const e=await this._azureADTokenProvider();if(!e||"string"!==typeof e)throw new l.OpenAIError(`Expected 'azureADTokenProvider' argument to return a string but it returned ${e}`);return e}}authHeaders(e){return{}}async prepareOptions(e){if(e.headers?.["api-key"])return super.prepareOptions(e);const t=await this._getAzureADToken();if(e.headers??(e.headers={}),t)e.headers["Authorization"]=`Bearer ${t}`;else{if(this.apiKey===x)throw new l.OpenAIError("Unable to handle auth");e.headers["api-key"]=this.apiKey}return super.prepareOptions(e)}}t.AzureOpenAI=S;const C=new Set(["/completions","/chat/completions","/embeddings","/audio/transcriptions","/audio/translations","/audio/speech","/images/generations"]),x="<Missing Key>";var M=n(78999);Object.defineProperty(t,"toFile",{enumerable:!0,get:function(){return M.toFile}}),Object.defineProperty(t,"fileFromPath",{enumerable:!0,get:function(){return M.fileFromPath}});var F=n(18815);Object.defineProperty(t,"OpenAIError",{enumerable:!0,get:function(){return F.OpenAIError}}),Object.defineProperty(t,"APIError",{enumerable:!0,get:function(){return F.APIError}}),Object.defineProperty(t,"APIConnectionError",{enumerable:!0,get:function(){return F.APIConnectionError}}),Object.defineProperty(t,"APIConnectionTimeoutError",{enumerable:!0,get:function(){return F.APIConnectionTimeoutError}}),Object.defineProperty(t,"APIUserAbortError",{enumerable:!0,get:function(){return F.APIUserAbortError}}),Object.defineProperty(t,"NotFoundError",{enumerable:!0,get:function(){return F.NotFoundError}}),Object.defineProperty(t,"ConflictError",{enumerable:!0,get:function(){return F.ConflictError}}),Object.defineProperty(t,"RateLimitError",{enumerable:!0,get:function(){return F.RateLimitError}}),Object.defineProperty(t,"BadRequestError",{enumerable:!0,get:function(){return F.BadRequestError}}),Object.defineProperty(t,"AuthenticationError",{enumerable:!0,get:function(){return F.AuthenticationError}}),Object.defineProperty(t,"InternalServerError",{enumerable:!0,get:function(){return F.InternalServerError}}),Object.defineProperty(t,"PermissionDeniedError",{enumerable:!0,get:function(){return F.PermissionDeniedError}}),Object.defineProperty(t,"UnprocessableEntityError",{enumerable:!0,get:function(){return F.UnprocessableEntityError}}),t=e.exports=j,e.exports.AzureOpenAI=S,t["default"]=j},51711:function(e,t,n){"use strict";n(44114);var r,s,o,i,a,c,l,u,d=this&&this.__classPrivateFieldSet||function(e,t,n,r,s){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!s)throw new TypeError("Private accessor was defined without a setter");if("function"===typeof t?e!==t||!s:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?s.call(e,n):s?s.value=n:t.set(e,n),n},f=this&&this.__classPrivateFieldGet||function(e,t,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"===typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(e):r?r.value:t.get(e)};Object.defineProperty(t,"__esModule",{value:!0}),t.ResponseStream=void 0;const h=n(18815),p=n(20757),m=n(530);class g extends p.EventStream{constructor(e){super(),r.add(this),s.set(this,void 0),o.set(this,void 0),i.set(this,void 0),d(this,s,e,"f")}static createResponse(e,t,n){const r=new g(t);return r._run((()=>r._createResponse(e,t,{...n,headers:{...n?.headers,"X-Stainless-Helper-Method":"stream"}}))),r}async _createResponse(e,t,n){const s=n?.signal;s&&(s.aborted&&this.controller.abort(),s.addEventListener("abort",(()=>this.controller.abort()))),f(this,r,"m",a).call(this);const o=await e.responses.create({...t,stream:!0},{...n,signal:this.controller.signal});this._connected();for await(const i of o)f(this,r,"m",c).call(this,i);if(o.controller.signal?.aborted)throw new h.APIUserAbortError;return f(this,r,"m",l).call(this)}[(s=new WeakMap,o=new WeakMap,i=new WeakMap,r=new WeakSet,a=function(){this.ended||d(this,o,void 0,"f")},c=function(e){if(this.ended)return;const t=f(this,r,"m",u).call(this,e);switch(this._emit("event",e),e.type){case"response.output_text.delta":{const n=t.output[e.output_index];if(!n)throw new h.OpenAIError(`missing output at index ${e.output_index}`);if("message"===n.type){const t=n.content[e.content_index];if(!t)throw new h.OpenAIError(`missing content at index ${e.content_index}`);if("output_text"!==t.type)throw new h.OpenAIError(`expected content to be 'output_text', got ${t.type}`);this._emit("response.output_text.delta",{...e,snapshot:t.text})}break}case"response.function_call_arguments.delta":{const n=t.output[e.output_index];if(!n)throw new h.OpenAIError(`missing output at index ${e.output_index}`);"function_call"===n.type&&this._emit("response.function_call_arguments.delta",{...e,snapshot:n.arguments});break}default:this._emit(e.type,e);break}},l=function(){if(this.ended)throw new h.OpenAIError("stream has ended, this shouldn't happen");const e=f(this,o,"f");if(!e)throw new h.OpenAIError("request ended without sending any events");d(this,o,void 0,"f");const t=b(e,f(this,s,"f"));return d(this,i,t,"f"),t},u=function(e){let t=f(this,o,"f");if(!t){if("response.created"!==e.type)throw new h.OpenAIError(`When snapshot hasn't been set yet, expected 'response.created' event, got ${e.type}`);return t=d(this,o,e.response,"f"),t}switch(e.type){case"response.output_item.added":t.output.push(e.item);break;case"response.content_part.added":{const n=t.output[e.output_index];if(!n)throw new h.OpenAIError(`missing output at index ${e.output_index}`);"message"===n.type&&n.content.push(e.part);break}case"response.output_text.delta":{const n=t.output[e.output_index];if(!n)throw new h.OpenAIError(`missing output at index ${e.output_index}`);if("message"===n.type){const t=n.content[e.content_index];if(!t)throw new h.OpenAIError(`missing content at index ${e.content_index}`);if("output_text"!==t.type)throw new h.OpenAIError(`expected content to be 'output_text', got ${t.type}`);t.text+=e.delta}break}case"response.function_call_arguments.delta":{const n=t.output[e.output_index];if(!n)throw new h.OpenAIError(`missing output at index ${e.output_index}`);"function_call"===n.type&&(n.arguments+=e.delta);break}case"response.completed":d(this,o,e.response,"f");break}return t},Symbol.asyncIterator)](){const e=[],t=[];let n=!1;return this.on("event",(n=>{const r=t.shift();r?r.resolve(n):e.push(n)})),this.on("end",(()=>{n=!0;for(const e of t)e.resolve(void 0);t.length=0})),this.on("abort",(e=>{n=!0;for(const n of t)n.reject(e);t.length=0})),this.on("error",(e=>{n=!0;for(const n of t)n.reject(e);t.length=0})),{next:async()=>{if(!e.length)return n?{value:void 0,done:!0}:new Promise(((e,n)=>t.push({resolve:e,reject:n}))).then((e=>e?{value:e,done:!1}:{value:void 0,done:!0}));const r=e.shift();return{value:r,done:!1}},return:async()=>(this.abort(),{value:void 0,done:!0})}}async finalResponse(){await this.done();const e=f(this,i,"f");if(!e)throw new h.OpenAIError("stream ended without producing a ChatCompletion");return e}}function b(e,t){return(0,m.maybeParseResponse)(e,t)}t.ResponseStream=g},55048:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getRuntime=void 0;const r=n(97187);function s({manuallyImported:e}={}){const t=e?"You may need to use polyfills":"Add one of these imports before your first `import  from 'openai'`:\n- `import 'openai/shims/node'` (if you're running on Node)\n- `import 'openai/shims/web'` (otherwise)\n";let n,s,o,i;try{n=fetch,s=Request,o=Response,i=Headers}catch(a){throw new Error(`this environment is missing the following Web Fetch API type: ${a.message}. ${t}`)}return{kind:"web",fetch:n,Request:s,Response:o,Headers:i,FormData:"undefined"!==typeof FormData?FormData:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'FormData' is undefined. ${t}`)}},Blob:"undefined"!==typeof Blob?Blob:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'Blob' is undefined. ${t}`)}},File:"undefined"!==typeof File?File:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'File' is undefined. ${t}`)}},ReadableStream:"undefined"!==typeof ReadableStream?ReadableStream:class{constructor(){throw new Error(`streaming isn't supported in this environment yet as 'ReadableStream' is undefined. ${t}`)}},getMultipartRequestOptions:async(e,t)=>({...t,body:new r.MultipartBody(e)}),getDefaultAgent:e=>{},fileFromPath:()=>{throw new Error("The `fileFromPath` function is only supported in Node. See the README for more details: https://www.github.com/openai/openai-node#file-uploads")},isFsReadStream:e=>!1}}t.getRuntime=s},55972:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RFC3986=t.RFC1738=t.formatters=t.default_format=void 0,t.default_format="RFC3986",t.formatters={RFC1738:e=>String(e).replace(/%20/g,"+"),RFC3986:e=>String(e)},t.RFC1738="RFC1738",t.RFC3986="RFC3986"},56030:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Messages=t.Completions=t.ChatCompletionsPage=t.ChatCompletionStoreMessagesPage=void 0;var r=n(63625);Object.defineProperty(t,"ChatCompletionStoreMessagesPage",{enumerable:!0,get:function(){return r.ChatCompletionStoreMessagesPage}}),Object.defineProperty(t,"ChatCompletionsPage",{enumerable:!0,get:function(){return r.ChatCompletionsPage}}),Object.defineProperty(t,"Completions",{enumerable:!0,get:function(){return r.Completions}});var s=n(73660);Object.defineProperty(t,"Messages",{enumerable:!0,get:function(){return s.Messages}})},56497:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.APIResource=void 0;class n{constructor(e){this._client=e}}t.APIResource=n},56725:function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var s=Object.getOwnPropertyDescriptor(t,n);s&&!("get"in s?!t.__esModule:s.writable||s.configurable)||(s={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,s)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e["default"]=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return s(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.Threads=void 0;const i=n(56497),a=n(25370),c=n(90197),l=o(n(29386)),u=n(29386),d=o(n(20045)),f=n(20045);class h extends i.APIResource{constructor(){super(...arguments),this.runs=new d.Runs(this._client),this.messages=new l.Messages(this._client)}create(e={},t){return(0,a.isRequestOptions)(e)?this.create({},e):this._client.post("/threads",{body:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t?.headers}})}retrieve(e,t){return this._client.get(`/threads/${e}`,{...t,headers:{"OpenAI-Beta":"assistants=v2",...t?.headers}})}update(e,t,n){return this._client.post(`/threads/${e}`,{body:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}del(e,t){return this._client.delete(`/threads/${e}`,{...t,headers:{"OpenAI-Beta":"assistants=v2",...t?.headers}})}createAndRun(e,t){return this._client.post("/threads/runs",{body:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t?.headers},stream:e.stream??!1})}async createAndRunPoll(e,t){const n=await this.createAndRun(e,t);return await this.runs.poll(n.thread_id,n.id,t)}createAndRunStream(e,t){return c.AssistantStream.createThreadAssistantStream(e,this._client.beta.threads,t)}}t.Threads=h,h.Runs=f.Runs,h.RunsPage=f.RunsPage,h.Messages=u.Messages,h.MessagesPage=u.MessagesPage},58893:function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var s=Object.getOwnPropertyDescriptor(t,n);s&&!("get"in s?!t.__esModule:s.writable||s.configurable)||(s={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,s)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e["default"]=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return s(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.Realtime=void 0;const i=n(56497),a=o(n(95057)),c=n(95057),l=o(n(23874)),u=n(23874);class d extends i.APIResource{constructor(){super(...arguments),this.sessions=new a.Sessions(this._client),this.transcriptionSessions=new l.TranscriptionSessions(this._client)}}t.Realtime=d,d.Sessions=c.Sessions,d.TranscriptionSessions=u.TranscriptionSessions},63625:function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var s=Object.getOwnPropertyDescriptor(t,n);s&&!("get"in s?!t.__esModule:s.writable||s.configurable)||(s={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,s)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e["default"]=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return s(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.ChatCompletionStoreMessagesPage=t.ChatCompletionsPage=t.Completions=void 0;const i=n(56497),a=n(25370),c=o(n(73660)),l=n(73660),u=n(84873);class d extends i.APIResource{constructor(){super(...arguments),this.messages=new c.Messages(this._client)}create(e,t){return this._client.post("/chat/completions",{body:e,...t,stream:e.stream??!1})}retrieve(e,t){return this._client.get(`/chat/completions/${e}`,t)}update(e,t,n){return this._client.post(`/chat/completions/${e}`,{body:t,...n})}list(e={},t){return(0,a.isRequestOptions)(e)?this.list({},e):this._client.getAPIList("/chat/completions",f,{query:e,...t})}del(e,t){return this._client.delete(`/chat/completions/${e}`,t)}}t.Completions=d;class f extends u.CursorPage{}t.ChatCompletionsPage=f;class h extends u.CursorPage{}t.ChatCompletionStoreMessagesPage=h,d.ChatCompletionsPage=f,d.Messages=l.Messages},64929:function(e,t,n){"use strict";n.r(t),n.d(t,{Blob:function(){return l},File:function(){return u},FormData:function(){return c},Headers:function(){return a},ReadableStream:function(){return d},Request:function(){return o},Response:function(){return i},auto:function(){return g},fetch:function(){return s},fileFromPath:function(){return p},getDefaultAgent:function(){return h},getMultipartRequestOptions:function(){return f},isFsReadStream:function(){return m},kind:function(){return r},setShims:function(){return b}});let r,s,o,i,a,c,l,u,d,f,h,p,m,g=!1;function b(e,t={auto:!1}){if(g)throw new Error(`you must \`import 'openai/shims/${e.kind}'\` before importing anything else from openai`);if(r)throw new Error(`can't \`import 'openai/shims/${e.kind}'\` after \`import 'openai/shims/${r}'\``);g=t.auto,r=e.kind,s=e.fetch,o=e.Request,i=e.Response,a=e.Headers,c=e.FormData,l=e.Blob,u=e.File,d=e.ReadableStream,f=e.getMultipartRequestOptions,h=e.getDefaultAgent,p=e.fileFromPath,m=e.isFsReadStream}},66947:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BatchesPage=t.Batches=void 0;const r=n(56497),s=n(25370),o=n(84873);class i extends r.APIResource{create(e,t){return this._client.post("/batches",{body:e,...t})}retrieve(e,t){return this._client.get(`/batches/${e}`,t)}list(e={},t){return(0,s.isRequestOptions)(e)?this.list({},e):this._client.getAPIList("/batches",a,{query:e,...t})}cancel(e,t){return this._client.post(`/batches/${e}/cancel`,t)}}t.Batches=i;class a extends o.CursorPage{}t.BatchesPage=a,i.BatchesPage=a},69493:function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var s=Object.getOwnPropertyDescriptor(t,n);s&&!("get"in s?!t.__esModule:s.writable||s.configurable)||(s={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,s)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e["default"]=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return s(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.Checkpoints=void 0;const i=n(56497),a=o(n(91162)),c=n(91162);class l extends i.APIResource{constructor(){super(...arguments),this.permissions=new a.Permissions(this._client)}}t.Checkpoints=l,l.Permissions=c.Permissions,l.PermissionCreateResponsesPage=c.PermissionCreateResponsesPage},70007:function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var s=Object.getOwnPropertyDescriptor(t,n);s&&!("get"in s?!t.__esModule:s.writable||s.configurable)||(s={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,s)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e["default"]=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return s(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.FineTuningJobEventsPage=t.FineTuningJobsPage=t.Jobs=void 0;const i=n(56497),a=n(25370),c=o(n(8332)),l=n(8332),u=n(84873);class d extends i.APIResource{constructor(){super(...arguments),this.checkpoints=new c.Checkpoints(this._client)}create(e,t){return this._client.post("/fine_tuning/jobs",{body:e,...t})}retrieve(e,t){return this._client.get(`/fine_tuning/jobs/${e}`,t)}list(e={},t){return(0,a.isRequestOptions)(e)?this.list({},e):this._client.getAPIList("/fine_tuning/jobs",f,{query:e,...t})}cancel(e,t){return this._client.post(`/fine_tuning/jobs/${e}/cancel`,t)}listEvents(e,t={},n){return(0,a.isRequestOptions)(t)?this.listEvents(e,{},t):this._client.getAPIList(`/fine_tuning/jobs/${e}/events`,h,{query:t,...n})}}t.Jobs=d;class f extends u.CursorPage{}t.FineTuningJobsPage=f;class h extends u.CursorPage{}t.FineTuningJobEventsPage=h,d.FineTuningJobsPage=f,d.FineTuningJobEventsPage=h,d.Checkpoints=l.Checkpoints,d.FineTuningJobCheckpointsPage=l.FineTuningJobCheckpointsPage},70263:function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var s=Object.getOwnPropertyDescriptor(t,n);s&&!("get"in s?!t.__esModule:s.writable||s.configurable)||(s={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,s)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),s=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),s(n(55048),t)},71173:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AssistantsPage=t.Assistants=void 0;const r=n(56497),s=n(25370),o=n(84873);n(90197);class i extends r.APIResource{create(e,t){return this._client.post("/assistants",{body:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t?.headers}})}retrieve(e,t){return this._client.get(`/assistants/${e}`,{...t,headers:{"OpenAI-Beta":"assistants=v2",...t?.headers}})}update(e,t,n){return this._client.post(`/assistants/${e}`,{body:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}list(e={},t){return(0,s.isRequestOptions)(e)?this.list({},e):this._client.getAPIList("/assistants",a,{query:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t?.headers}})}del(e,t){return this._client.delete(`/assistants/${e}`,{...t,headers:{"OpenAI-Beta":"assistants=v2",...t?.headers}})}}t.Assistants=i;class a extends o.CursorPage{}t.AssistantsPage=a,i.AssistantsPage=a},72360:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isPresent=t.isToolMessage=t.isFunctionMessage=t.isAssistantMessage=void 0;const n=e=>"assistant"===e?.role;t.isAssistantMessage=n;const r=e=>"function"===e?.role;t.isFunctionMessage=r;const s=e=>"tool"===e?.role;function o(e){return null!=e}t.isToolMessage=s,t.isPresent=o},73660:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ChatCompletionStoreMessagesPage=t.Messages=void 0;const r=n(56497),s=n(25370),o=n(63625);Object.defineProperty(t,"ChatCompletionStoreMessagesPage",{enumerable:!0,get:function(){return o.ChatCompletionStoreMessagesPage}});class i extends r.APIResource{list(e,t={},n){return(0,s.isRequestOptions)(t)?this.list(e,{},t):this._client.getAPIList(`/chat/completions/${e}/messages`,o.ChatCompletionStoreMessagesPage,{query:t,...n})}}t.Messages=i},74178:function(e,t,n){"use strict";n(18111),n(20116),n(61701),n(13579),Object.defineProperty(t,"__esModule",{value:!0}),t.validateInputTools=t.hasAutoParseableInput=t.shouldParseToolCall=t.parseChatCompletion=t.maybeParseChatCompletion=t.isAutoParsableTool=t.makeParseableTool=t.isAutoParsableResponseFormat=t.makeParseableTextFormat=t.makeParseableResponseFormat=void 0;const r=n(18815);function s(e,t){const n={...e};return Object.defineProperties(n,{$brand:{value:"auto-parseable-response-format",enumerable:!1},$parseRaw:{value:t,enumerable:!1}}),n}function o(e,t){const n={...e};return Object.defineProperties(n,{$brand:{value:"auto-parseable-response-format",enumerable:!1},$parseRaw:{value:t,enumerable:!1}}),n}function i(e){return"auto-parseable-response-format"===e?.["$brand"]}function a(e,{parser:t,callback:n}){const r={...e};return Object.defineProperties(r,{$brand:{value:"auto-parseable-tool",enumerable:!1},$parseRaw:{value:t,enumerable:!1},$callback:{value:n,enumerable:!1}}),r}function c(e){return"auto-parseable-tool"===e?.["$brand"]}function l(e,t){return t&&p(t)?u(e,t):{...e,choices:e.choices.map((e=>({...e,message:{...e.message,parsed:null,...e.message.tool_calls?{tool_calls:e.message.tool_calls}:void 0}})))}}function u(e,t){const n=e.choices.map((e=>{if("length"===e.finish_reason)throw new r.LengthFinishReasonError;if("content_filter"===e.finish_reason)throw new r.ContentFilterFinishReasonError;return{...e,message:{...e.message,...e.message.tool_calls?{tool_calls:e.message.tool_calls?.map((e=>f(t,e)))??void 0}:void 0,parsed:e.message.content&&!e.message.refusal?d(t,e.message.content):null}}}));return{...e,choices:n}}function d(e,t){if("json_schema"!==e.response_format?.type)return null;if("json_schema"===e.response_format?.type){if("$parseRaw"in e.response_format){const n=e.response_format;return n.$parseRaw(t)}return JSON.parse(t)}return null}function f(e,t){const n=e.tools?.find((e=>e.function?.name===t.function.name));return{...t,function:{...t.function,parsed_arguments:c(n)?n.$parseRaw(t.function.arguments):n?.function.strict?JSON.parse(t.function.arguments):null}}}function h(e,t){if(!e)return!1;const n=e.tools?.find((e=>e.function?.name===t.function.name));return c(n)||n?.function.strict||!1}function p(e){return!!i(e.response_format)||(e.tools?.some((e=>c(e)||"function"===e.type&&!0===e.function.strict))??!1)}function m(e){for(const t of e??[]){if("function"!==t.type)throw new r.OpenAIError(`Currently only \`function\` tool types support auto-parsing; Received \`${t.type}\``);if(!0!==t.function.strict)throw new r.OpenAIError(`The \`${t.function.name}\` tool is not marked with \`strict: true\`. Only strict function tools can be auto-parsed`)}}t.makeParseableResponseFormat=s,t.makeParseableTextFormat=o,t.isAutoParsableResponseFormat=i,t.makeParseableTool=a,t.isAutoParsableTool=c,t.maybeParseChatCompletion=l,t.parseChatCompletion=u,t.shouldParseToolCall=h,t.hasAutoParseableInput=p,t.validateInputTools=m},74427:function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var s=Object.getOwnPropertyDescriptor(t,n);s&&!("get"in s?!t.__esModule:s.writable||s.configurable)||(s={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,s)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e["default"]=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return s(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.Chat=void 0;const i=n(56497),a=o(n(30218));class c extends i.APIResource{constructor(){super(...arguments),this.completions=new a.Completions(this._client)}}t.Chat=c,function(e){e.Completions=a.Completions}(c=t.Chat||(t.Chat={}))},76632:function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var s=Object.getOwnPropertyDescriptor(t,n);s&&!("get"in s?!t.__esModule:s.writable||s.configurable)||(s={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,s)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e["default"]=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return s(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.ResponseItemsPage=t.Responses=void 0;const i=n(530),a=n(25370),c=n(56497),l=o(n(21821)),u=n(21821),d=n(51711),f=n(84873);class h extends c.APIResource{constructor(){super(...arguments),this.inputItems=new l.InputItems(this._client)}create(e,t){return this._client.post("/responses",{body:e,...t,stream:e.stream??!1})._thenUnwrap((e=>("object"in e&&"response"===e.object&&(0,i.addOutputText)(e),e)))}retrieve(e,t={},n){return(0,a.isRequestOptions)(t)?this.retrieve(e,{},t):this._client.get(`/responses/${e}`,{query:t,...n})}del(e,t){return this._client.delete(`/responses/${e}`,{...t,headers:{Accept:"*/*",...t?.headers}})}parse(e,t){return this._client.responses.create(e,t)._thenUnwrap((t=>(0,i.parseResponse)(t,e)))}stream(e,t){return d.ResponseStream.createResponse(this._client,e,t)}}t.Responses=h;class p extends f.CursorPage{}t.ResponseItemsPage=p,h.InputItems=u.InputItems},77661:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ModelsPage=t.Models=void 0;const r=n(56497),s=n(84873);class o extends r.APIResource{retrieve(e,t){return this._client.get(`/models/${e}`,t)}list(e){return this._client.getAPIList("/models",i,e)}del(e,t){return this._client.delete(`/models/${e}`,t)}}t.Models=o;class i extends s.Page{}t.ModelsPage=i,o.ModelsPage=i},78999:function(e,t,n){"use strict";n(44114),n(18111),n(61701),n(13579),Object.defineProperty(t,"__esModule",{value:!0}),t.createForm=t.multipartFormRequestOptions=t.maybeMultipartFormRequestOptions=t.isMultipartBody=t.toFile=t.isUploadable=t.isBlobLike=t.isFileLike=t.isResponseLike=t.fileFromPath=void 0;const r=n(86551);var s=n(86551);Object.defineProperty(t,"fileFromPath",{enumerable:!0,get:function(){return s.fileFromPath}});const o=e=>null!=e&&"object"===typeof e&&"string"===typeof e.url&&"function"===typeof e.blob;t.isResponseLike=o;const i=e=>null!=e&&"object"===typeof e&&"string"===typeof e.name&&"number"===typeof e.lastModified&&(0,t.isBlobLike)(e);t.isFileLike=i;const a=e=>null!=e&&"object"===typeof e&&"number"===typeof e.size&&"string"===typeof e.type&&"function"===typeof e.text&&"function"===typeof e.slice&&"function"===typeof e.arrayBuffer;t.isBlobLike=a;const c=e=>(0,t.isFileLike)(e)||(0,t.isResponseLike)(e)||(0,r.isFsReadStream)(e);async function l(e,n,s){if(e=await e,(0,t.isFileLike)(e))return e;if((0,t.isResponseLike)(e)){const o=await e.blob();n||(n=new URL(e.url).pathname.split(/[\\/]/).pop()??"unknown_file");const i=(0,t.isBlobLike)(o)?[await o.arrayBuffer()]:[o];return new r.File(i,n,s)}const o=await u(e);if(n||(n=f(e)??"unknown_file"),!s?.type){const e=o[0]?.type;"string"===typeof e&&(s={...s,type:e})}return new r.File(o,n,s)}async function u(e){let n=[];if("string"===typeof e||ArrayBuffer.isView(e)||e instanceof ArrayBuffer)n.push(e);else if((0,t.isBlobLike)(e))n.push(await e.arrayBuffer());else{if(!p(e))throw new Error(`Unexpected data type: ${typeof e}; constructor: ${e?.constructor?.name}; props: ${d(e)}`);for await(const t of e)n.push(t)}return n}function d(e){const t=Object.getOwnPropertyNames(e);return`[${t.map((e=>`"${e}"`)).join(", ")}]`}function f(e){return h(e.name)||h(e.filename)||h(e.path)?.split(/[\\/]/).pop()}t.isUploadable=c,t.toFile=l;const h=e=>"string"===typeof e?e:"undefined"!==typeof Buffer&&e instanceof Buffer?String(e):void 0,p=e=>null!=e&&"object"===typeof e&&"function"===typeof e[Symbol.asyncIterator],m=e=>e&&"object"===typeof e&&e.body&&"MultipartBody"===e[Symbol.toStringTag];t.isMultipartBody=m;const g=async e=>{if(!_(e.body))return e;const n=await(0,t.createForm)(e.body);return(0,r.getMultipartRequestOptions)(n,e)};t.maybeMultipartFormRequestOptions=g;const b=async e=>{const n=await(0,t.createForm)(e.body);return(0,r.getMultipartRequestOptions)(n,e)};t.multipartFormRequestOptions=b;const y=async e=>{const t=new r.FormData;return await Promise.all(Object.entries(e||{}).map((([e,n])=>w(t,e,n)))),t};t.createForm=y;const _=e=>{if((0,t.isUploadable)(e))return!0;if(Array.isArray(e))return e.some(_);if(e&&"object"===typeof e)for(const t in e)if(_(e[t]))return!0;return!1},w=async(e,n,r)=>{if(void 0!==r){if(null==r)throw new TypeError(`Received null for "${n}"; to pass null in FormData, you must use the string 'null'`);if("string"===typeof r||"number"===typeof r||"boolean"===typeof r)e.append(n,String(r));else if((0,t.isUploadable)(r)){const t=await l(r);e.append(n,t)}else if(Array.isArray(r))await Promise.all(r.map((t=>w(e,n+"[]",t))));else{if("object"!==typeof r)throw new TypeError(`Invalid value given to form, expected a string, number, boolean, object, Array, File or Blob but got ${r} instead`);await Promise.all(Object.entries(r).map((([t,r])=>w(e,`${n}[${t}]`,r))))}}}},79293:function(e,t,n){"use strict";n(44114),n(18111),n(22489),Object.defineProperty(t,"__esModule",{value:!0}),t.allSettledWithThrow=void 0;const r=async e=>{const t=await Promise.allSettled(e),n=t.filter((e=>"rejected"===e.status));if(n.length){for(const e of n)console.error(e.reason);throw new Error(`${n.length} promise(s) failed - see the above errors`)}const r=[];for(const s of t)"fulfilled"===s.status&&r.push(s.value);return r};t.allSettledWithThrow=r},82757:function(e,t,n){"use strict";n(44114),n(18111),n(61701),Object.defineProperty(t,"__esModule",{value:!0}),t.VectorStoreFilesPage=t.FileBatches=void 0;const r=n(56497),s=n(25370),o=n(25370),i=n(79293),a=n(38827);Object.defineProperty(t,"VectorStoreFilesPage",{enumerable:!0,get:function(){return a.VectorStoreFilesPage}});class c extends r.APIResource{create(e,t,n){return this._client.post(`/vector_stores/${e}/file_batches`,{body:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}retrieve(e,t,n){return this._client.get(`/vector_stores/${e}/file_batches/${t}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}cancel(e,t,n){return this._client.post(`/vector_stores/${e}/file_batches/${t}/cancel`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}async createAndPoll(e,t,n){const r=await this.create(e,t);return await this.poll(e,r.id,n)}listFiles(e,t,n={},r){return(0,s.isRequestOptions)(n)?this.listFiles(e,t,{},n):this._client.getAPIList(`/vector_stores/${e}/file_batches/${t}/files`,a.VectorStoreFilesPage,{query:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r?.headers}})}async poll(e,t,n){const r={...n?.headers,"X-Stainless-Poll-Helper":"true"};n?.pollIntervalMs&&(r["X-Stainless-Custom-Poll-Interval"]=n.pollIntervalMs.toString());while(1){const{data:s,response:i}=await this.retrieve(e,t,{...n,headers:r}).withResponse();switch(s.status){case"in_progress":let e=5e3;if(n?.pollIntervalMs)e=n.pollIntervalMs;else{const t=i.headers.get("openai-poll-after-ms");if(t){const n=parseInt(t);isNaN(n)||(e=n)}}await(0,o.sleep)(e);break;case"failed":case"cancelled":case"completed":return s}}}async uploadAndPoll(e,{files:t,fileIds:n=[]},r){if(null==t||0==t.length)throw new Error("No `files` provided to process. If you've already uploaded files you should use `.createAndPoll()` instead");const s=r?.maxConcurrency??5,o=Math.min(s,t.length),a=this._client,c=t.values(),l=[...n];async function u(e){for(let t of e){const e=await a.files.create({file:t,purpose:"assistants"},r);l.push(e.id)}}const d=Array(o).fill(c).map(u);return await(0,i.allSettledWithThrow)(d),await this.createAndPoll(e,{file_ids:l})}}t.FileBatches=c},83752:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RunStepsPage=t.Steps=void 0;const r=n(56497),s=n(25370),o=n(84873);class i extends r.APIResource{retrieve(e,t,n,r={},o){return(0,s.isRequestOptions)(r)?this.retrieve(e,t,n,{},r):this._client.get(`/threads/${e}/runs/${t}/steps/${n}`,{query:r,...o,headers:{"OpenAI-Beta":"assistants=v2",...o?.headers}})}list(e,t,n={},r){return(0,s.isRequestOptions)(n)?this.list(e,t,{},n):this._client.getAPIList(`/threads/${e}/runs/${t}/steps`,a,{query:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r?.headers}})}}t.Steps=i;class a extends o.CursorPage{}t.RunStepsPage=a,i.RunStepsPage=a},84873:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CursorPage=t.Page=void 0;const r=n(25370);class s extends r.AbstractPage{constructor(e,t,n,r){super(e,t,n,r),this.data=n.data||[],this.object=n.object}getPaginatedItems(){return this.data??[]}nextPageParams(){return null}nextPageInfo(){return null}}t.Page=s;class o extends r.AbstractPage{constructor(e,t,n,r){super(e,t,n,r),this.data=n.data||[],this.has_more=n.has_more||!1}getPaginatedItems(){return this.data??[]}hasNextPage(){return!1!==this.has_more&&super.hasNextPage()}nextPageParams(){const e=this.nextPageInfo();if(!e)return null;if("params"in e)return e.params;const t=Object.fromEntries(e.url.searchParams);return Object.keys(t).length?t:null}nextPageInfo(){const e=this.getPaginatedItems();if(!e.length)return null;const t=e[e.length-1]?.id;return t?{params:{after:t}}:null}}t.CursorPage=o},86551:function(e,t,n){const r=n(64929),s=n(70263);t.init=()=>{r.kind||r.setShims(s.getRuntime(),{auto:!0})};for(const o of Object.keys(r))Object.defineProperty(t,o,{get(){return r[o]}});t.init()},87148:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Completions=void 0;const r=n(56497);class s extends r.APIResource{create(e,t){return this._client.post("/completions",{body:e,...t,stream:e.stream??!1})}}t.Completions=s},88074:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Completions=t.ChatCompletionsPage=t.ChatCompletionStoreMessagesPage=t.Chat=void 0;var r=n(23406);Object.defineProperty(t,"Chat",{enumerable:!0,get:function(){return r.Chat}});var s=n(56030);Object.defineProperty(t,"ChatCompletionStoreMessagesPage",{enumerable:!0,get:function(){return s.ChatCompletionStoreMessagesPage}}),Object.defineProperty(t,"ChatCompletionsPage",{enumerable:!0,get:function(){return s.ChatCompletionsPage}}),Object.defineProperty(t,"Completions",{enumerable:!0,get:function(){return s.Completions}})},88653:function(e,t,n){"use strict";n(18111),n(7588);var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var s=Object.getOwnPropertyDescriptor(t,n);s&&!("get"in s?!t.__esModule:s.writable||s.configurable)||(s={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,s)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e["default"]=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return s(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.Embeddings=void 0;const i=n(56497),a=o(n(25370));class c extends i.APIResource{create(e,t){const n=!!e.encoding_format;let r=n?e.encoding_format:"base64";n&&a.debug("Request","User defined encoding_format:",e.encoding_format);const s=this._client.post("/embeddings",{body:{...e,encoding_format:r},...t});return n?s:(a.debug("response","Decoding base64 embeddings to float32 array"),s._thenUnwrap((e=>(e&&e.data&&e.data.forEach((e=>{const t=e.embedding;e.embedding=a.toFloat32Array(t)})),e))))}}t.Embeddings=c},88729:function(e,t,n){"use strict";n(44114),n(18111),n(20116),n(61701),n(17642),n(58004),n(33853),n(45876),n(32475),n(15024),n(31698);var r,s,o,i,a,c,l,u,d,f,h,p,m=this&&this.__classPrivateFieldSet||function(e,t,n,r,s){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!s)throw new TypeError("Private accessor was defined without a setter");if("function"===typeof t?e!==t||!s:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?s.call(e,n):s?s.value=n:t.set(e,n),n},g=this&&this.__classPrivateFieldGet||function(e,t,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"===typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(e):r?r.value:t.get(e)};Object.defineProperty(t,"__esModule",{value:!0}),t.ChatCompletionStream=void 0;const b=n(18815),y=n(34925),_=n(25701),w=n(74178),v=n(50033);class P extends y.AbstractChatCompletionRunner{constructor(e){super(),r.add(this),s.set(this,void 0),o.set(this,void 0),i.set(this,void 0),m(this,s,e,"f"),m(this,o,[],"f")}get currentChatCompletionSnapshot(){return g(this,i,"f")}static fromReadableStream(e){const t=new P(null);return t._run((()=>t._fromReadableStream(e))),t}static createChatCompletion(e,t,n){const r=new P(t);return r._run((()=>r._runChatCompletion(e,{...t,stream:!0},{...n,headers:{...n?.headers,"X-Stainless-Helper-Method":"stream"}}))),r}async _createChatCompletion(e,t,n){super._createChatCompletion;const s=n?.signal;s&&(s.aborted&&this.controller.abort(),s.addEventListener("abort",(()=>this.controller.abort()))),g(this,r,"m",a).call(this);const o=await e.chat.completions.create({...t,stream:!0},{...n,signal:this.controller.signal});this._connected();for await(const i of o)g(this,r,"m",l).call(this,i);if(o.controller.signal?.aborted)throw new b.APIUserAbortError;return this._addChatCompletion(g(this,r,"m",f).call(this))}async _fromReadableStream(e,t){const n=t?.signal;n&&(n.aborted&&this.controller.abort(),n.addEventListener("abort",(()=>this.controller.abort()))),g(this,r,"m",a).call(this),this._connected();const s=_.Stream.fromReadableStream(e,this.controller);let o;for await(const i of s)o&&o!==i.id&&this._addChatCompletion(g(this,r,"m",f).call(this)),g(this,r,"m",l).call(this,i),o=i.id;if(s.controller.signal?.aborted)throw new b.APIUserAbortError;return this._addChatCompletion(g(this,r,"m",f).call(this))}[(s=new WeakMap,o=new WeakMap,i=new WeakMap,r=new WeakSet,a=function(){this.ended||m(this,i,void 0,"f")},c=function(e){let t=g(this,o,"f")[e.index];return t||(t={content_done:!1,refusal_done:!1,logprobs_content_done:!1,logprobs_refusal_done:!1,done_tool_calls:new Set,current_tool_call_index:null},g(this,o,"f")[e.index]=t,t)},l=function(e){if(this.ended)return;const t=g(this,r,"m",p).call(this,e);this._emit("chunk",e,t);for(const n of e.choices){const e=t.choices[n.index];null!=n.delta.content&&"assistant"===e.message?.role&&e.message?.content&&(this._emit("content",n.delta.content,e.message.content),this._emit("content.delta",{delta:n.delta.content,snapshot:e.message.content,parsed:e.message.parsed})),null!=n.delta.refusal&&"assistant"===e.message?.role&&e.message?.refusal&&this._emit("refusal.delta",{delta:n.delta.refusal,snapshot:e.message.refusal}),null!=n.logprobs?.content&&"assistant"===e.message?.role&&this._emit("logprobs.content.delta",{content:n.logprobs?.content,snapshot:e.logprobs?.content??[]}),null!=n.logprobs?.refusal&&"assistant"===e.message?.role&&this._emit("logprobs.refusal.delta",{refusal:n.logprobs?.refusal,snapshot:e.logprobs?.refusal??[]});const s=g(this,r,"m",c).call(this,e);e.finish_reason&&(g(this,r,"m",d).call(this,e),null!=s.current_tool_call_index&&g(this,r,"m",u).call(this,e,s.current_tool_call_index));for(const t of n.delta.tool_calls??[])s.current_tool_call_index!==t.index&&(g(this,r,"m",d).call(this,e),null!=s.current_tool_call_index&&g(this,r,"m",u).call(this,e,s.current_tool_call_index)),s.current_tool_call_index=t.index;for(const t of n.delta.tool_calls??[]){const n=e.message.tool_calls?.[t.index];n?.type&&("function"===n?.type?this._emit("tool_calls.function.arguments.delta",{name:n.function?.name,index:t.index,arguments:n.function.arguments,parsed_arguments:n.function.parsed_arguments,arguments_delta:t.function?.arguments??""}):I(n?.type))}}},u=function(e,t){const n=g(this,r,"m",c).call(this,e);if(n.done_tool_calls.has(t))return;const o=e.message.tool_calls?.[t];if(!o)throw new Error("no tool call snapshot");if(!o.type)throw new Error("tool call snapshot missing `type`");if("function"===o.type){const e=g(this,s,"f")?.tools?.find((e=>"function"===e.type&&e.function.name===o.function.name));this._emit("tool_calls.function.arguments.done",{name:o.function.name,index:t,arguments:o.function.arguments,parsed_arguments:(0,w.isAutoParsableTool)(e)?e.$parseRaw(o.function.arguments):e?.function.strict?JSON.parse(o.function.arguments):null})}else I(o.type)},d=function(e){const t=g(this,r,"m",c).call(this,e);if(e.message.content&&!t.content_done){t.content_done=!0;const n=g(this,r,"m",h).call(this);this._emit("content.done",{content:e.message.content,parsed:n?n.$parseRaw(e.message.content):null})}e.message.refusal&&!t.refusal_done&&(t.refusal_done=!0,this._emit("refusal.done",{refusal:e.message.refusal})),e.logprobs?.content&&!t.logprobs_content_done&&(t.logprobs_content_done=!0,this._emit("logprobs.content.done",{content:e.logprobs.content})),e.logprobs?.refusal&&!t.logprobs_refusal_done&&(t.logprobs_refusal_done=!0,this._emit("logprobs.refusal.done",{refusal:e.logprobs.refusal}))},f=function(){if(this.ended)throw new b.OpenAIError("stream has ended, this shouldn't happen");const e=g(this,i,"f");if(!e)throw new b.OpenAIError("request ended without sending any chunks");return m(this,i,void 0,"f"),m(this,o,[],"f"),O(e,g(this,s,"f"))},h=function(){const e=g(this,s,"f")?.response_format;return(0,w.isAutoParsableResponseFormat)(e)?e:null},p=function(e){var t,n,o,a;let c=g(this,i,"f");const{choices:l,...u}=e;c?Object.assign(c,u):c=m(this,i,{...u,choices:[]},"f");for(const{delta:i,finish_reason:d,index:f,logprobs:p=null,...m}of e.choices){let e=c.choices[f];if(e||(e=c.choices[f]={finish_reason:d,index:f,message:{},logprobs:p,...m}),p)if(e.logprobs){const{content:r,refusal:s,...o}=p;R(o),Object.assign(e.logprobs,o),r&&((t=e.logprobs).content??(t.content=[]),e.logprobs.content.push(...r)),s&&((n=e.logprobs).refusal??(n.refusal=[]),e.logprobs.refusal.push(...s))}else e.logprobs=Object.assign({},p);if(d&&(e.finish_reason=d,g(this,s,"f")&&(0,w.hasAutoParseableInput)(g(this,s,"f")))){if("length"===d)throw new b.LengthFinishReasonError;if("content_filter"===d)throw new b.ContentFilterFinishReasonError}if(Object.assign(e,m),!i)continue;const{content:l,refusal:u,function_call:y,role:_,tool_calls:P,...O}=i;if(R(O),Object.assign(e.message,O),u&&(e.message.refusal=(e.message.refusal||"")+u),_&&(e.message.role=_),y&&(e.message.function_call?(y.name&&(e.message.function_call.name=y.name),y.arguments&&((o=e.message.function_call).arguments??(o.arguments=""),e.message.function_call.arguments+=y.arguments)):e.message.function_call=y),l&&(e.message.content=(e.message.content||"")+l,!e.message.refusal&&g(this,r,"m",h).call(this)&&(e.message.parsed=(0,v.partialParse)(e.message.content))),P){e.message.tool_calls||(e.message.tool_calls=[]);for(const{index:t,id:n,type:r,function:o,...i}of P){const c=(a=e.message.tool_calls)[t]??(a[t]={});Object.assign(c,i),n&&(c.id=n),r&&(c.type=r),o&&(c.function??(c.function={name:o.name??"",arguments:""})),o?.name&&(c.function.name=o.name),o?.arguments&&(c.function.arguments+=o.arguments,(0,w.shouldParseToolCall)(g(this,s,"f"),c)&&(c.function.parsed_arguments=(0,v.partialParse)(c.function.arguments)))}}}return c},Symbol.asyncIterator)](){const e=[],t=[];let n=!1;return this.on("chunk",(n=>{const r=t.shift();r?r.resolve(n):e.push(n)})),this.on("end",(()=>{n=!0;for(const e of t)e.resolve(void 0);t.length=0})),this.on("abort",(e=>{n=!0;for(const n of t)n.reject(e);t.length=0})),this.on("error",(e=>{n=!0;for(const n of t)n.reject(e);t.length=0})),{next:async()=>{if(!e.length)return n?{value:void 0,done:!0}:new Promise(((e,n)=>t.push({resolve:e,reject:n}))).then((e=>e?{value:e,done:!1}:{value:void 0,done:!0}));const r=e.shift();return{value:r,done:!1}},return:async()=>(this.abort(),{value:void 0,done:!0})}}toReadableStream(){const e=new _.Stream(this[Symbol.asyncIterator].bind(this),this.controller);return e.toReadableStream()}}function O(e,t){const{id:n,choices:r,created:s,model:o,system_fingerprint:i,...a}=e,c={...a,id:n,choices:r.map((({message:t,finish_reason:n,index:r,logprobs:s,...o})=>{if(!n)throw new b.OpenAIError(`missing finish_reason for choice ${r}`);const{content:i=null,function_call:a,tool_calls:c,...l}=t,u=t.role;if(!u)throw new b.OpenAIError(`missing role for choice ${r}`);if(a){const{arguments:e,name:c}=a;if(null==e)throw new b.OpenAIError(`missing function_call.arguments for choice ${r}`);if(!c)throw new b.OpenAIError(`missing function_call.name for choice ${r}`);return{...o,message:{content:i,function_call:{arguments:e,name:c},role:u,refusal:t.refusal??null},finish_reason:n,index:r,logprobs:s}}return c?{...o,index:r,finish_reason:n,logprobs:s,message:{...l,role:u,content:i,refusal:t.refusal??null,tool_calls:c.map(((t,n)=>{const{function:s,type:o,id:i,...a}=t,{arguments:c,name:l,...u}=s||{};if(null==i)throw new b.OpenAIError(`missing choices[${r}].tool_calls[${n}].id\n${A(e)}`);if(null==o)throw new b.OpenAIError(`missing choices[${r}].tool_calls[${n}].type\n${A(e)}`);if(null==l)throw new b.OpenAIError(`missing choices[${r}].tool_calls[${n}].function.name\n${A(e)}`);if(null==c)throw new b.OpenAIError(`missing choices[${r}].tool_calls[${n}].function.arguments\n${A(e)}`);return{...a,id:i,type:o,function:{...u,name:l,arguments:c}}}))}}:{...o,message:{...l,content:i,role:u,refusal:t.refusal??null},finish_reason:n,index:r,logprobs:s}})),created:s,model:o,object:"chat.completion",...i?{system_fingerprint:i}:{}};return(0,w.maybeParseChatCompletion)(c,t)}function A(e){return JSON.stringify(e)}function R(e){}function I(e){}t.ChatCompletionStream=P},90197:function(e,t,n){"use strict";n(44114),n(18111),n(81148);var r,s,o,i,a,c,l,u,d,f,h,p,m,g,b,y,_,w,v,P,O,A,R=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var s=Object.getOwnPropertyDescriptor(t,n);s&&!("get"in s?!t.__esModule:s.writable||s.configurable)||(s={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,s)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),I=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e["default"]=t}),E=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&R(t,e,n);return I(t,e),t},j=this&&this.__classPrivateFieldGet||function(e,t,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"===typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(e):r?r.value:t.get(e)},S=this&&this.__classPrivateFieldSet||function(e,t,n,r,s){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!s)throw new TypeError("Private accessor was defined without a setter");if("function"===typeof t?e!==t||!s:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?s.call(e,n):s?s.value=n:t.set(e,n),n};Object.defineProperty(t,"__esModule",{value:!0}),t.AssistantStream=void 0;const C=E(n(25370)),x=n(25701),M=n(18815),F=n(20757);class T extends F.EventStream{constructor(){super(...arguments),r.add(this),s.set(this,[]),o.set(this,{}),i.set(this,{}),a.set(this,void 0),c.set(this,void 0),l.set(this,void 0),u.set(this,void 0),d.set(this,void 0),f.set(this,void 0),h.set(this,void 0),p.set(this,void 0),m.set(this,void 0)}[(s=new WeakMap,o=new WeakMap,i=new WeakMap,a=new WeakMap,c=new WeakMap,l=new WeakMap,u=new WeakMap,d=new WeakMap,f=new WeakMap,h=new WeakMap,p=new WeakMap,m=new WeakMap,r=new WeakSet,Symbol.asyncIterator)](){const e=[],t=[];let n=!1;return this.on("event",(n=>{const r=t.shift();r?r.resolve(n):e.push(n)})),this.on("end",(()=>{n=!0;for(const e of t)e.resolve(void 0);t.length=0})),this.on("abort",(e=>{n=!0;for(const n of t)n.reject(e);t.length=0})),this.on("error",(e=>{n=!0;for(const n of t)n.reject(e);t.length=0})),{next:async()=>{if(!e.length)return n?{value:void 0,done:!0}:new Promise(((e,n)=>t.push({resolve:e,reject:n}))).then((e=>e?{value:e,done:!1}:{value:void 0,done:!0}));const r=e.shift();return{value:r,done:!1}},return:async()=>(this.abort(),{value:void 0,done:!0})}}static fromReadableStream(e){const t=new T;return t._run((()=>t._fromReadableStream(e))),t}async _fromReadableStream(e,t){const n=t?.signal;n&&(n.aborted&&this.controller.abort(),n.addEventListener("abort",(()=>this.controller.abort()))),this._connected();const s=x.Stream.fromReadableStream(e,this.controller);for await(const o of s)j(this,r,"m",g).call(this,o);if(s.controller.signal?.aborted)throw new M.APIUserAbortError;return this._addRun(j(this,r,"m",b).call(this))}toReadableStream(){const e=new x.Stream(this[Symbol.asyncIterator].bind(this),this.controller);return e.toReadableStream()}static createToolAssistantStream(e,t,n,r,s){const o=new T;return o._run((()=>o._runToolAssistantStream(e,t,n,r,{...s,headers:{...s?.headers,"X-Stainless-Helper-Method":"stream"}}))),o}async _createToolAssistantStream(e,t,n,s,o){const i=o?.signal;i&&(i.aborted&&this.controller.abort(),i.addEventListener("abort",(()=>this.controller.abort())));const a={...s,stream:!0},c=await e.submitToolOutputs(t,n,a,{...o,signal:this.controller.signal});this._connected();for await(const l of c)j(this,r,"m",g).call(this,l);if(c.controller.signal?.aborted)throw new M.APIUserAbortError;return this._addRun(j(this,r,"m",b).call(this))}static createThreadAssistantStream(e,t,n){const r=new T;return r._run((()=>r._threadAssistantStream(e,t,{...n,headers:{...n?.headers,"X-Stainless-Helper-Method":"stream"}}))),r}static createAssistantStream(e,t,n,r){const s=new T;return s._run((()=>s._runAssistantStream(e,t,n,{...r,headers:{...r?.headers,"X-Stainless-Helper-Method":"stream"}}))),s}currentEvent(){return j(this,h,"f")}currentRun(){return j(this,p,"f")}currentMessageSnapshot(){return j(this,a,"f")}currentRunStepSnapshot(){return j(this,m,"f")}async finalRunSteps(){return await this.done(),Object.values(j(this,o,"f"))}async finalMessages(){return await this.done(),Object.values(j(this,i,"f"))}async finalRun(){if(await this.done(),!j(this,c,"f"))throw Error("Final run was not received.");return j(this,c,"f")}async _createThreadAssistantStream(e,t,n){const s=n?.signal;s&&(s.aborted&&this.controller.abort(),s.addEventListener("abort",(()=>this.controller.abort())));const o={...t,stream:!0},i=await e.createAndRun(o,{...n,signal:this.controller.signal});this._connected();for await(const a of i)j(this,r,"m",g).call(this,a);if(i.controller.signal?.aborted)throw new M.APIUserAbortError;return this._addRun(j(this,r,"m",b).call(this))}async _createAssistantStream(e,t,n,s){const o=s?.signal;o&&(o.aborted&&this.controller.abort(),o.addEventListener("abort",(()=>this.controller.abort())));const i={...n,stream:!0},a=await e.create(t,i,{...s,signal:this.controller.signal});this._connected();for await(const c of a)j(this,r,"m",g).call(this,c);if(a.controller.signal?.aborted)throw new M.APIUserAbortError;return this._addRun(j(this,r,"m",b).call(this))}static accumulateDelta(e,t){for(const[n,r]of Object.entries(t)){if(!e.hasOwnProperty(n)){e[n]=r;continue}let t=e[n];if(null!==t&&void 0!==t)if("index"!==n&&"type"!==n){if("string"===typeof t&&"string"===typeof r)t+=r;else if("number"===typeof t&&"number"===typeof r)t+=r;else{if(!C.isObj(t)||!C.isObj(r)){if(Array.isArray(t)&&Array.isArray(r)){if(t.every((e=>"string"===typeof e||"number"===typeof e))){t.push(...r);continue}for(const e of r){if(!C.isObj(e))throw new Error(`Expected array delta entry to be an object but got: ${e}`);const n=e["index"];if(null==n)throw console.error(e),new Error("Expected array delta entry to have an `index` property");if("number"!==typeof n)throw new Error(`Expected array delta entry \`index\` property to be a number but got ${n}`);const r=t[n];null==r?t.push(e):t[n]=this.accumulateDelta(r,e)}continue}throw Error(`Unhandled record type: ${n}, deltaValue: ${r}, accValue: ${t}`)}t=this.accumulateDelta(t,r)}e[n]=t}else e[n]=r;else e[n]=r}return e}_addRun(e){return e}async _threadAssistantStream(e,t,n){return await this._createThreadAssistantStream(t,e,n)}async _runAssistantStream(e,t,n,r){return await this._createAssistantStream(t,e,n,r)}async _runToolAssistantStream(e,t,n,r,s){return await this._createToolAssistantStream(n,e,t,r,s)}}function k(e){}t.AssistantStream=T,g=function(e){if(!this.ended)switch(S(this,h,e,"f"),j(this,r,"m",w).call(this,e),e.event){case"thread.created":break;case"thread.run.created":case"thread.run.queued":case"thread.run.in_progress":case"thread.run.requires_action":case"thread.run.completed":case"thread.run.incomplete":case"thread.run.failed":case"thread.run.cancelling":case"thread.run.cancelled":case"thread.run.expired":j(this,r,"m",A).call(this,e);break;case"thread.run.step.created":case"thread.run.step.in_progress":case"thread.run.step.delta":case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":j(this,r,"m",_).call(this,e);break;case"thread.message.created":case"thread.message.in_progress":case"thread.message.delta":case"thread.message.completed":case"thread.message.incomplete":j(this,r,"m",y).call(this,e);break;case"error":throw new Error("Encountered an error event in event processing - errors should be processed earlier");default:k(e)}},b=function(){if(this.ended)throw new M.OpenAIError("stream has ended, this shouldn't happen");if(!j(this,c,"f"))throw Error("Final run has not been received");return j(this,c,"f")},y=function(e){const[t,n]=j(this,r,"m",P).call(this,e,j(this,a,"f"));S(this,a,t,"f"),j(this,i,"f")[t.id]=t;for(const r of n){const e=t.content[r.index];"text"==e?.type&&this._emit("textCreated",e.text)}switch(e.event){case"thread.message.created":this._emit("messageCreated",e.data);break;case"thread.message.in_progress":break;case"thread.message.delta":if(this._emit("messageDelta",e.data.delta,t),e.data.delta.content)for(const n of e.data.delta.content){if("text"==n.type&&n.text){let e=n.text,r=t.content[n.index];if(!r||"text"!=r.type)throw Error("The snapshot associated with this text delta is not text or missing");this._emit("textDelta",e,r.text)}if(n.index!=j(this,l,"f")){if(j(this,u,"f"))switch(j(this,u,"f").type){case"text":this._emit("textDone",j(this,u,"f").text,j(this,a,"f"));break;case"image_file":this._emit("imageFileDone",j(this,u,"f").image_file,j(this,a,"f"));break}S(this,l,n.index,"f")}S(this,u,t.content[n.index],"f")}break;case"thread.message.completed":case"thread.message.incomplete":if(void 0!==j(this,l,"f")){const t=e.data.content[j(this,l,"f")];if(t)switch(t.type){case"image_file":this._emit("imageFileDone",t.image_file,j(this,a,"f"));break;case"text":this._emit("textDone",t.text,j(this,a,"f"));break}}j(this,a,"f")&&this._emit("messageDone",e.data),S(this,a,void 0,"f")}},_=function(e){const t=j(this,r,"m",v).call(this,e);switch(S(this,m,t,"f"),e.event){case"thread.run.step.created":this._emit("runStepCreated",e.data);break;case"thread.run.step.delta":const n=e.data.delta;if(n.step_details&&"tool_calls"==n.step_details.type&&n.step_details.tool_calls&&"tool_calls"==t.step_details.type)for(const e of n.step_details.tool_calls)e.index==j(this,d,"f")?this._emit("toolCallDelta",e,t.step_details.tool_calls[e.index]):(j(this,f,"f")&&this._emit("toolCallDone",j(this,f,"f")),S(this,d,e.index,"f"),S(this,f,t.step_details.tool_calls[e.index],"f"),j(this,f,"f")&&this._emit("toolCallCreated",j(this,f,"f")));this._emit("runStepDelta",e.data.delta,t);break;case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":S(this,m,void 0,"f");const r=e.data.step_details;"tool_calls"==r.type&&j(this,f,"f")&&(this._emit("toolCallDone",j(this,f,"f")),S(this,f,void 0,"f")),this._emit("runStepDone",e.data,t);break;case"thread.run.step.in_progress":break}},w=function(e){j(this,s,"f").push(e),this._emit("event",e)},v=function(e){switch(e.event){case"thread.run.step.created":return j(this,o,"f")[e.data.id]=e.data,e.data;case"thread.run.step.delta":let t=j(this,o,"f")[e.data.id];if(!t)throw Error("Received a RunStepDelta before creation of a snapshot");let n=e.data;if(n.delta){const r=T.accumulateDelta(t,n.delta);j(this,o,"f")[e.data.id]=r}return j(this,o,"f")[e.data.id];case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":case"thread.run.step.in_progress":j(this,o,"f")[e.data.id]=e.data;break}if(j(this,o,"f")[e.data.id])return j(this,o,"f")[e.data.id];throw new Error("No snapshot available")},P=function(e,t){let n=[];switch(e.event){case"thread.message.created":return[e.data,n];case"thread.message.delta":if(!t)throw Error("Received a delta with no existing snapshot (there should be one from message creation)");let s=e.data;if(s.delta.content)for(const e of s.delta.content)if(e.index in t.content){let n=t.content[e.index];t.content[e.index]=j(this,r,"m",O).call(this,e,n)}else t.content[e.index]=e,n.push(e);return[t,n];case"thread.message.in_progress":case"thread.message.completed":case"thread.message.incomplete":if(t)return[t,n];throw Error("Received thread message event with no existing snapshot")}throw Error("Tried to accumulate a non-message event")},O=function(e,t){return T.accumulateDelta(t,e)},A=function(e){switch(S(this,p,e.data,"f"),e.event){case"thread.run.created":break;case"thread.run.queued":break;case"thread.run.in_progress":break;case"thread.run.requires_action":case"thread.run.cancelled":case"thread.run.failed":case"thread.run.completed":case"thread.run.expired":S(this,c,e.data,"f"),j(this,f,"f")&&(this._emit("toolCallDone",j(this,f,"f")),S(this,f,void 0,"f"));break;case"thread.run.cancelling":break}}},91162:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PermissionCreateResponsesPage=t.Permissions=void 0;const r=n(56497),s=n(25370),o=n(84873);class i extends r.APIResource{create(e,t,n){return this._client.getAPIList(`/fine_tuning/checkpoints/${e}/permissions`,a,{body:t,method:"post",...n})}retrieve(e,t={},n){return(0,s.isRequestOptions)(t)?this.retrieve(e,{},t):this._client.get(`/fine_tuning/checkpoints/${e}/permissions`,{query:t,...n})}del(e,t,n){return this._client.delete(`/fine_tuning/checkpoints/${e}/permissions/${t}`,n)}}t.Permissions=i;class a extends o.Page{}t.PermissionCreateResponsesPage=a,i.PermissionCreateResponsesPage=a},91533:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.VERSION=void 0,t.VERSION="4.97.0"},95057:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Sessions=void 0;const r=n(56497);class s extends r.APIResource{create(e,t){return this._client.post("/realtime/sessions",{body:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t?.headers}})}}t.Sessions=s},97187:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MultipartBody=void 0;class n{constructor(e){this.body=e}get[Symbol.toStringTag](){return"MultipartBody"}}t.MultipartBody=n},98107:function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var s=Object.getOwnPropertyDescriptor(t,n);s&&!("get"in s?!t.__esModule:s.writable||s.configurable)||(s={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,s)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),s=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),t.VectorStores=t.VectorStoreSearchResponsesPage=t.VectorStoresPage=t.Uploads=t.Responses=t.Moderations=t.Models=t.ModelsPage=t.Images=t.FineTuning=t.Files=t.FileObjectsPage=t.Evals=t.EvalListResponsesPage=t.Embeddings=t.Completions=t.Beta=t.Batches=t.BatchesPage=t.Audio=void 0,s(n(88074),t),s(n(46630),t);var o=n(39960);Object.defineProperty(t,"Audio",{enumerable:!0,get:function(){return o.Audio}});var i=n(66947);Object.defineProperty(t,"BatchesPage",{enumerable:!0,get:function(){return i.BatchesPage}}),Object.defineProperty(t,"Batches",{enumerable:!0,get:function(){return i.Batches}});var a=n(43254);Object.defineProperty(t,"Beta",{enumerable:!0,get:function(){return a.Beta}});var c=n(87148);Object.defineProperty(t,"Completions",{enumerable:!0,get:function(){return c.Completions}});var l=n(88653);Object.defineProperty(t,"Embeddings",{enumerable:!0,get:function(){return l.Embeddings}});var u=n(964);Object.defineProperty(t,"EvalListResponsesPage",{enumerable:!0,get:function(){return u.EvalListResponsesPage}}),Object.defineProperty(t,"Evals",{enumerable:!0,get:function(){return u.Evals}});var d=n(22836);Object.defineProperty(t,"FileObjectsPage",{enumerable:!0,get:function(){return d.FileObjectsPage}}),Object.defineProperty(t,"Files",{enumerable:!0,get:function(){return d.Files}});var f=n(45152);Object.defineProperty(t,"FineTuning",{enumerable:!0,get:function(){return f.FineTuning}});var h=n(38365);Object.defineProperty(t,"Images",{enumerable:!0,get:function(){return h.Images}});var p=n(77661);Object.defineProperty(t,"ModelsPage",{enumerable:!0,get:function(){return p.ModelsPage}}),Object.defineProperty(t,"Models",{enumerable:!0,get:function(){return p.Models}});var m=n(20690);Object.defineProperty(t,"Moderations",{enumerable:!0,get:function(){return m.Moderations}});var g=n(76632);Object.defineProperty(t,"Responses",{enumerable:!0,get:function(){return g.Responses}});var b=n(26924);Object.defineProperty(t,"Uploads",{enumerable:!0,get:function(){return b.Uploads}});var y=n(3448);Object.defineProperty(t,"VectorStoresPage",{enumerable:!0,get:function(){return y.VectorStoresPage}}),Object.defineProperty(t,"VectorStoreSearchResponsesPage",{enumerable:!0,get:function(){return y.VectorStoreSearchResponsesPage}}),Object.defineProperty(t,"VectorStores",{enumerable:!0,get:function(){return y.VectorStores}})}}]);
//# sourceMappingURL=701.1d25fd70.js.map